<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"><title>WebGoat实战: General | Time of Pi</title><meta name="keywords" content="WebGoat"><meta name="author" content="Foo"><meta name="copyright" content="Foo"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="网络对抗原理实验（一）"><meta property="og:type" content="article"><meta property="og:title" content="WebGoat实战: General"><meta property="og:url" content="https://foopi.top/posts/4cfedd8d/index.html"><meta property="og:site_name" content="Time of Pi"><meta property="og:description" content="网络对抗原理实验（一）"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://img.foopi.top/cover/nicebrain.webp"><meta property="article:published_time" content="2021-05-25T10:48:34.000Z"><meta property="article:modified_time" content="2022-04-03T06:25:02.045Z"><meta property="article:author" content="Foo"><meta property="article:tag" content="WebGoat"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://img.foopi.top/cover/nicebrain.webp"><link rel="shortcut icon" href="https://img.foopi.top/img/favicon.webp"><link rel="canonical" href="https://foopi.top/posts/4cfedd8d/"><link rel="preconnect" href="//cdn.jsdelivr.net"><link rel="preconnect" href="//static.cloudflareinsights.com"><link rel="preconnect" href="//busuanzi.ibruce.info"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6/css/all.min.css" media="print" onload='this.media="all"'><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css" media="print" onload='this.media="all"'><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.css" media="print" onload='this.media="all"'><script defer data-pjax="data-pjax" src="https://static.cloudflareinsights.com/beacon.min.js" data-cf-beacon="{&quot;token&quot;: &quot;1167d76d896d415ebda0de73b6b5f2e8&quot;}"></script><script>const GLOBAL_CONFIG={root:"/",algolia:void 0,localSearch:void 0,translate:void 0,noticeOutdate:void 0,highlight:{plugin:"highlighjs",highlightCopy:!0,highlightLang:!0,highlightHeightLimit:192},copy:{success:"复制成功",error:"复制错误",noSupport:"浏览器不支持"},relativeDate:{homepage:!1,post:!0},runtime:"天",date_suffix:{just:"刚刚",min:"分钟前",hour:"小时前",day:"天前",month:"个月前"},copyright:void 0,lightbox:"fancybox",Snackbar:{chs_to_cht:"你已切换为繁体",cht_to_chs:"你已切换为简体",day_to_night:"你已切换为深色模式",night_to_day:"你已切换为浅色模式",bgLight:"#49b1f5",bgDark:"#121212",position:"bottom-left"},source:{justifiedGallery:{js:"https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.js",css:"https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.css"}},isPhotoFigcaption:!1,islazyload:!0,isAnchor:!0}</script><script id="config-diff">var GLOBAL_CONFIG_SITE={title:"WebGoat实战: General",isPost:!0,isHome:!1,isHighlightShrink:!1,isToc:!0,postUpdate:"2022-04-03 14:25:02"}</script><noscript><style>#nav{opacity:1}.justified-gallery img{opacity:1}#post-meta time,#recent-posts time{display:inline!important}</style></noscript><script>(e=>{e.saveToLocal={set:function(e,t,o){if(0===o)return;const n=864e5*o,a={value:t,expiry:(new Date).getTime()+n};localStorage.setItem(e,JSON.stringify(a))},get:function(e){const t=localStorage.getItem(e);if(!t)return;const o=JSON.parse(t);if(!((new Date).getTime()>o.expiry))return o.value;localStorage.removeItem(e)}},e.getScript=e=>new Promise((t,o)=>{const n=document.createElement("script");n.src=e,n.async=!0,n.onerror=o,n.onload=n.onreadystatechange=function(){const e=this.readyState;e&&"loaded"!==e&&"complete"!==e||(n.onload=n.onreadystatechange=null,t())},document.head.appendChild(n)}),e.activateDarkMode=function(){document.documentElement.setAttribute("data-theme","dark"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","#0d0d0d")},e.activateLightMode=function(){document.documentElement.setAttribute("data-theme","light"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","#ffffff")};const t=saveToLocal.get("theme");"dark"===t?activateDarkMode():"light"===t&&activateLightMode();const o=saveToLocal.get("aside-status");void 0!==o&&("hide"===o?document.documentElement.classList.add("hide-aside"):document.documentElement.classList.remove("hide-aside"));/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)&&document.documentElement.classList.add("apple")})(window)</script><meta name="generator" content="Hexo 5.4.1"></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">加载中...</div></div></div><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://img.foopi.top/img/loading.gif" data-lazy-src="https://img.foopi.top/img/avatar.webp" onerror='onerror=null,src="/img/friend_404.gif"' alt="avatar"></div><div class="site-data is-center"><div class="data-item"><a href="/archives/"><div class="headline">文章</div><div class="length-num">28</div></a></div><div class="data-item"><a href="/tags/"><div class="headline">标签</div><div class="length-num">11</div></a></div><div class="data-item"><a href="/categories/"><div class="headline">分类</div><div class="length-num">12</div></a></div></div><hr><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i> <span>Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i> <span>Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i> <span>Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i> <span>Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i> <span>links</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image:url(https://img.foopi.top/cover/nicebrain.webp)"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">Time of Pi</a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i> <span>Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i> <span>Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i> <span>Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i> <span>Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i> <span>links</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">WebGoat实战: General</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2021-05-25T10:48:34.000Z" title="发表于 2021-05-25 18:48:34">2021-05-25</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2022-04-03T06:25:02.045Z" title="更新于 2022-04-03 14:25:02">2022-04-03</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E6%83%B3%E8%A6%81%E6%AF%95%E4%B8%9A/">想要毕业</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E6%83%B3%E8%A6%81%E6%AF%95%E4%B8%9A/%E7%BD%91%E7%BB%9C%E5%AF%B9%E6%8A%97%E5%8E%9F%E7%90%86/">网络对抗原理</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">3.9k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>23分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" data-flag-title="WebGoat实战: General"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><blockquote><p>WebGoat is a deliberately insecure web application maintained by <a target="_blank" rel="noopener external nofollow noreferrer" href="http://www.owasp.org/">OWASP</a> designed to teach web application security lessons.</p></blockquote><h2 id="环境搭建">环境搭建</h2><p>尹老师力推Fedora，本实验使用的是<code>Parallels Desktop</code>中安装的<code>Fedora32</code>虚拟机。</p><h3 id="安装-docker">安装 docker</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">sudo dnf install docker<br></code></pre></td></tr></table></figure><img src="https://img.foopi.top/img/loading.gif" data-lazy-src="https://img.foopi.top/postpic/dnf install docker.webp" alt="dnf install docker" style="zoom:67%"><h3 id="更换-docker-源">更换 docker 源</h3><p>我使用的是<a target="_blank" rel="noopener external nofollow noreferrer" href="https://cr.console.aliyun.com/cn-hangzhou/instances/mirrors">阿里云的docker源</a>，需要阿里云用户的身份：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs shell">sudo mkdir -p /etc/docker<br>sudo tee /etc/docker/daemon.json &lt;&lt;-&#x27;EOF&#x27;<br>&#123;<br> &quot;registry-mirrors&quot;: [&quot;https://你的加速地址.mirror.aliyuncs.com&quot;]<br>&#125;<br>EOF<br>sudo systemctl daemon-reload<br>sudo systemctl restart docker<br></code></pre></td></tr></table></figure><h3 id="测试-hello-world">测试 hello-world</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">sudo docker run hello-world<br></code></pre></td></tr></table></figure><img src="https://img.foopi.top/img/loading.gif" data-lazy-src="https://img.foopi.top/postpic/docker run hello-world.webp" alt="docker run hello-world" style="zoom:67%"><h3 id="可能需要的设置">可能需要的设置</h3><p>距离搭建环境已经过去了六周时间，翻看<code>.zsh_history</code>注意到当初输入了这些命令，记录下来以备不时之需。<a target="_blank" rel="noopener external nofollow noreferrer" href="http://www.zzvips.com/article/87292.html">参考</a></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs shell">sudo grubby --update-kernel=ALL --args=&quot;systemd.unified_cgroup_hierarchy=0&quot;<br>sudo dnf install docker-compose<br>sudo firewall-cmd --permanent --zone=trusted --add-interface=docker0<br>sudo groupadd docker<br>sudo usermod -aG docker $USER<br>reboot<br></code></pre></td></tr></table></figure><h3 id="WebGoat-相关命令">WebGoat 相关命令</h3><p>第一次运行：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">docker run -p 8080:8080 -p 9090:9090 -e TZ=Asia/Shanghai webgoat/goatandwolf<br></code></pre></td></tr></table></figure><img src="https://img.foopi.top/img/loading.gif" data-lazy-src="https://img.foopi.top/postpic/run webgoat.webp" alt="run webgoat" style="zoom:67%"><p>停止容器：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">docker ps<br>docker stop 26cb91349941<br></code></pre></td></tr></table></figure><p>为了方便使用：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">docker run -itd --name webgoat -p 8080:8080 -p 9090:9090 -e TZ=Asia/Shanghai webgoat/goatandwolf<br>docker stop webgoat<br>docker start webgoat<br></code></pre></td></tr></table></figure><h2 id="Introduction">Introduction</h2><h3 id="WebGoat">WebGoat</h3><blockquote><p>WebGoat is a deliberately insecure application that allows interested developers just like you to <em>test vulnerabilities</em> commonly found in <strong>Java-based</strong> applications that use common and popular open source components.</p><p>Now, while we in no way condone causing intentional harm to any animal, goat or otherwise, we think learning everything you can about security vulnerabilities is essential to understanding just what happens when even a small bit of unintended code gets into your applications.</p><p>What better way to do that than with your very own <strong>scapegoat</strong>?</p><p>Feel free to do what you will with him. Hack, poke, prod and if it makes you feel better, scare him until your heart’s content. Go ahead, and hack the goat. We promise he likes it.</p><p>Thanks for your interest!</p></blockquote><h3 id="WebWolf">WebWolf</h3><blockquote><p>Some challenges requires to have a local web server running. WebWolf is for you the attacker it helps you while solving some of the assignments and challenges within WebGoat. An assignment might for example require you to serve a file or connect back to your own environment or to receive an e-mail. In order to not let you run WebGoat open and connected to the internet we provided these tools in this application, called WebWolf.</p></blockquote><p>介绍<code>WebWolf</code>及其相关功能，有两个小任务用于熟悉。</p><h2 id="General">General</h2><h3 id="HTTP-Basics">HTTP Basics</h3><p>All HTTP transactions follow the same general format. Each client request and server response has three parts: the request or response line, a header section and the entity body.</p><p>The client initiates a transaction as follows:</p><ul><li>The client contacts the server and sends a document request. A GET request can have url parameters and those parameters will be available in the web access logs.<ul><li>GET /index.html?param=value HTTP/1.0</li></ul></li><li>Next, the client sends optional header information to inform the server of its configuration and the document formats it will accept.<ul><li>User-Agent: Mozilla/4.06 Accept: image/gif,image/jpeg, /</li></ul></li><li>In a POST request, the user supplied data will follow the optional headers and is not part of the contained within the POST URL.</li></ul><img src="https://img.foopi.top/img/loading.gif" data-lazy-src="https://img.foopi.top/postpic/image-20210530100846519.webp" alt="image-20210530100846519" style="zoom:50%"><p>发送“abc&quot;，返回“cba“，大概是倒序输出字符串的功能。</p><p>通过Firefox浏览器自带的开发者工具可以看到，点击按钮”Go!“发出的是<code>POST</code>请求。</p><img src="https://img.foopi.top/img/loading.gif" data-lazy-src="https://img.foopi.top/postpic/image-20210530105847952.webp" alt="image-20210530105847952" style="zoom:50%"><h3 id="HTTP-Proxies">HTTP Proxies</h3><p>A proxy is some forwarder application that connects your http client to backend resources. HTTP clients can be browsers, or applications like curl, SOAP UI, Postman, etc. Usually these proxies are used for routing and getting access to internet when there is no direct connection to internet from the client itself. HTTP proxies are therefore also ideal when you are testing your application. You can always use the proxy log records to see what was actually sent from client to server. So you can check the request and response headers and the XML, JSON or other payload.</p><p>HTTP Proxies receive requests from a client and relay them. They also typically record them. They act as a man-in-the-middle. It even works fine with or without HTTPS as long as your client or browser trusts the certificate of the HTTP Proxy.</p><p>按步骤配置完<code>Zap</code>之后有个小任务——拦截并修改请求：</p><img src="https://img.foopi.top/img/loading.gif" data-lazy-src="https://img.foopi.top/postpic/image-20210530112507755.webp" alt="image-20210530112507755" style="zoom:50%"><p>修改前：</p><img src="https://img.foopi.top/img/loading.gif" data-lazy-src="https://img.foopi.top/postpic/image-20210530123736308.webp" alt="image-20210530123736308" style="zoom:50%"><p>修改后：</p><img src="https://img.foopi.top/img/loading.gif" data-lazy-src="https://img.foopi.top/postpic/image-20210530123503225.webp" alt="image-20210530123503225" style="zoom:50%"> <img src="https://img.foopi.top/img/loading.gif" data-lazy-src="https://img.foopi.top/postpic/image-20210530123845533.webp" alt="image-20210530123845533" style="zoom:50%"> <img src="https://img.foopi.top/img/loading.gif" data-lazy-src="https://img.foopi.top/postpic/image-20210530123527626.webp" alt="image-20210530123527626" style="zoom:50%"><h3 id="Developer-Tools">Developer Tools</h3><img src="https://img.foopi.top/img/loading.gif" data-lazy-src="https://img.foopi.top/postpic/image-20210530130827716.webp" alt="image-20210530130827716" style="zoom:50%"> <img src="https://img.foopi.top/img/loading.gif" data-lazy-src="https://img.foopi.top/postpic/image-20210530131016177.webp" alt="image-20210530131016177" style="zoom:50%"> <img src="https://img.foopi.top/img/loading.gif" data-lazy-src="https://img.foopi.top/postpic/image-20210530131727324.webp" alt="image-20210530131727324" style="zoom:50%"> <img src="https://img.foopi.top/img/loading.gif" data-lazy-src="https://img.foopi.top/postpic/image-20210530131832760.webp" alt="image-20210530131832760" style="zoom:50%"><h3 id="CIA-Triad">CIA Triad</h3><p>The CIA Triad (confidentiality, integrity, availability) is a model for information security. The three elements of the triad are considered the most crucial information security components and should be guaranteed in any secure system.</p><p>If only one of those three elements can be breached it can have serious consequences for the parties concerned.</p><p>The CIA Triad was created to provide a baseline standard for evaluating and implementing security regardless of the underlying system or/and organization.</p><h4 id="Confidentiality-机密性">Confidentiality 机密性</h4><p>Confidentiality is “the property, that information is not made available or disclosed to unauthorized individuals, entities, or processes.” In other words, confidentiality means to prevent sensitive information from reaching the wrong people, that should not get access to it, while at the same time making sure, that people that are allowed to access it, can get it.</p><p>While being similar to “privacy”, these two words are not interchangeable. Rather, confidentiality is a component of privacy that implements to protect our data from unauthorized viewers.</p><h4 id="Integrity-完整性">Integrity 完整性</h4><p>Integrity is “the property of accuracy and completeness.” In other words, integrity means to maintain the consistency, accuracy and trustworthiness of data over its entire life cycle. Data must not be changed during transit and it must be ensured, that data can not be altered by unauthorized people (per example in a breach of confidentiality).</p><h4 id="Availability-可用性">Availability 可用性</h4><p>Availability is “the property of being accessible and usable on demand by an authorized entity.” In other words all the information should be available and accessible for authorized persons whenever it is needed.</p><img src="https://img.foopi.top/img/loading.gif" data-lazy-src="https://img.foopi.top/postpic/image-20210530134218501.webp" alt="image-20210530134218501" style="zoom:50%"><h3 id="Crypto-Basics">Crypto Basics</h3><h4 id="Encoding-编码">Encoding 编码</h4><p>Encoding is not realy cryptography, but it is used a lot in all kinds of standards around cryptographic functions.</p><h5 id="Base64-Encoding">Base64 Encoding</h5><p>Base64 encoding is a technique used to transform all kinds of bytes to a specific range of bytes. This specific range is the ASCII readable bytes. This way you can transfer binary data such as secret or private keys more easily. You could even print these out or write them down. Encoding is also reversible. So if you have the encoded version, you can create the original version.</p><p>On wikipedia you can find more details. Basically it goes through all the bytes and transforms each set of 6 bits into a readable byte (8 bits). The result is that the size of the encoded bytes is increased with about 33%.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">Hello ==&gt; SGVsbG8=<br>0x4d 0x61 ==&gt; TWE=<br></code></pre></td></tr></table></figure><h5 id="Basic-Authentication">Basic Authentication</h5><p>Basic authentication is sometimes used by web applications. This uses base64 encoding. Therefore, it is important to at least use Transport Layer Security (TLS or more commonly known as https) to protect others from reading the username password that is sent to the server.</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">➜ ~ echo -n &quot;myuser:mypassword&quot; | base64<br>bXl1c2VyOm15cGFzc3dvcmQ=<br></code></pre></td></tr></table></figure><p>The HTTP header will look like:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">Authorization: Basic bXl1c2VyOm15cGFzc3dvcmQ=<br></code></pre></td></tr></table></figure><img src="https://img.foopi.top/img/loading.gif" data-lazy-src="https://img.foopi.top/postpic/image-20210530141104763.webp" alt="image-20210530141104763" style="zoom:50%"><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs shell">➜ ~ python3<br>Python 3.9.5 (default, May 4 2021, 03:36:27)<br>[Clang 12.0.0 (clang-1200.0.32.29)] on darwin<br>Type &quot;help&quot;, &quot;copyright&quot;, &quot;credits&quot; or &quot;license&quot; for more information.<br><span class="hljs-meta prompt_">&gt;</span><span class="language-bash">&gt;&gt; import <span class="hljs-built_in">base64</span></span><br><span class="hljs-meta prompt_">&gt;</span><span class="language-bash">&gt;&gt; str = <span class="hljs-string">&#x27;Zm9vd2ViZ29hdDphZG1pbg==&#x27;</span></span><br><span class="hljs-meta prompt_">&gt;</span><span class="language-bash">&gt;&gt; base64.decodebytes(str.encode(<span class="hljs-string">&#x27;utf8&#x27;</span>))</span><br>b&#x27;foowebgoat:admin&#x27;<br></code></pre></td></tr></table></figure><h5 id="HTML-encoding">HTML encoding</h5><p>HTML encoding is used a lot when sending form data and request parameters to the server. Since spaces are not allowed in a URL, this is then replaced by %20.</p><h5 id="UUEncode">UUEncode</h5><p>The Unix-2-Unix encoding has been used to send email attachments.</p><h5 id="XOR-encoding">XOR encoding</h5><p>Sometimes encoding is used as a first and simple obfuscation technique for storing passwords. IBM <strong>WebSphere</strong> Application Server e.g. uses a specific implementation of XOR encoding to store passwords in configuration files. IBM recommends to protect access to these files and to replace the default XOR encoding by your own custom encryption. However when these recommendations are not followed, these defaults can become a vulnerability.</p><img src="https://img.foopi.top/img/loading.gif" data-lazy-src="https://img.foopi.top/postpic/image-20210530141519598.webp" alt="image-20210530141519598" style="zoom:50%"><p><a target="_blank" rel="noopener external nofollow noreferrer" href="http://www.poweredbywebsphere.com/decoder.html">WebSphere Password Decoder</a></p><img src="https://img.foopi.top/img/loading.gif" data-lazy-src="https://img.foopi.top/postpic/image-20210530142812472.webp" alt="image-20210530142812472" style="zoom:50%"><h4 id="Hashing-哈希散列">Hashing 哈希散列</h4><h5 id="Plain-Hashing">Plain Hashing</h5><p>Hashing is a type of cryptography which is mostly used to detect if the original data has been changed. A hash is generated from the original data. It is based on irreversible cryptographic techniques. If the original data is changed by even one byte, the resulting hash is also different.</p><p>So in a way it looks like a secure technique. However, it is NOT and even NEVER a good solution when using it for passwords. The problem here is that you can generate passwords from dictionaries and calculate all kinds of variants from these passwords. For each password you can calculate a hash. This can all be stored in large databases. So whenever you find a hash that could be a password, you just look up the hash in the database and find out the password.</p><p>Some hashing algorithms should no longer be used: MD5, SHA-1 For these hashes it is possible to change the payload in such a way that it still results in the same hash. This takes a lot of computing power, but is still a feasible option.</p><h5 id="Salted-Hashes">Salted Hashes</h5><p>Plain passwords should obviously not be stored in a database. And the same goes for plain hashes. The <a target="_blank" rel="noopener external nofollow noreferrer" href="https://owasp.org/www-project-cheat-sheets/cheatsheets/Password_Storage_Cheat_Sheet.html">OWASP Password Storage Cheat Sheet</a> explains what should be used when password related information needs to be stored securely.</p><img src="https://img.foopi.top/img/loading.gif" data-lazy-src="https://img.foopi.top/postpic/image-20210530143635282.webp" alt="image-20210530143635282" style="zoom:50%"><p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://crackstation.net/">Free Password Hash Cracker</a></p><p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://cmd5.com/">CMD5</a></p><h4 id="Encryption-加密">Encryption 加密</h4><h5 id="HTTPS-uses-both-symmetric-and-asymmetric-keys">HTTPS uses both symmetric and asymmetric keys</h5><p>Here is a short description of what happens if you open your browser and go to an https site.</p><ul><li>Your browser connects to the server and gets the webserver certificate.</li><li>Your browser checks if it trusts the certificate issuer by checking if the issuer certificate is in its trust store. This trust store is managed by operating system and browser updates. And on some corporate networks it is managed by the company. From the certificate the browser obtains the public key.</li><li>The browser now generates random bytes to be used to generate a symmetric key and encrypts this with the public key of the server. So only the server can decrypt it.</li><li>At the end of this process both the browser and the webserver will use the exchanged symmetric key (in the asymmetric key exchange process) to encrypt and decrypt messages that are sent back and forth between the browser and the webserver.</li></ul><p>Symmetric keys are used because they can be used more safely for <strong>large amounts of data</strong>.</p><h4 id="Signing-签名">Signing 签名</h4><p>A signature is a hash that can be used to check the validity of some data. The signature can be supplied separately from the data that it validates, or in the case of CMS or SOAP can be included in the same file. (Where parts of that file contain the data and parts contain the signature).</p><p>Signing is used when integrity is important. It is meant to be a guarantee that data sent from A to B was not altered. So A signs the data by calculating the hash of the data and encrypting that hash using an asymmetric private key. B can then verify the data by calculating the hash of the data and decrypting the signature to compare if both hashes are the same.</p><h5 id="RAW-signatures">RAW signatures</h5><p>A raw signature is usually calculated as follows:</p><ul><li>create a hash of the data (e.g. SHA-256 hash)</li><li>encrypt the hash using an asymmetric private key (e.g. RSA 2048 bit key)</li><li>(optionally) encode the binary encrypted hash using base64 encoding</li></ul><p>B will have to get the certificate with the public key as well. This might have been exchanged before. So at least 3 files are involved: the data, the signature and the certificate.</p><h5 id="CMS-signatures">CMS signatures</h5><p>A CMS signature is a standardized way to send data + signature + certificate with the public key all in one file from A to B. As long as the certificate is valid and not revoked, B can use the supplied public key to verify the signature.</p><h5 id="SOAP-signatures">SOAP signatures</h5><p>A SOAP signature also contains data and the signature and optionally the certificate. All in one XML payload. There are special steps involved in calculating the hash of the data. This has to do with the fact that the SOAP XML sent from system to system might introduce extra elements or timestamps. Also, SOAP Signing offers the possibility to sign different parts of the message by different parties.</p><h5 id="Email-signatures">Email signatures</h5><p>Sending emails is not very difficult. You have to fill in some data and send it to a server that forwards it, and eventually it will end up at its destination. However, it is possible to send emails with a FROM field that is not your own email address. In order to guarantee to your receiver that you really sent this email, you can sign your email. A trusted third party will check your identity and issue an email signing certificate. You install the private key in your email application and configure it to sign emails that you send out. The certificate is issued on a specific email address and all others that receive this email will see an indication that the sender is verified, because their tools will verify the signature using the public certificate that was issued by the trusted third party.</p><h5 id="PDF-or-Word-or-other-signatures">PDF or Word or other signatures</h5><p>Adobe PDF documents and Microsoft Word documents are also examples of things that support signing. The signature is also inside the same document as the data so there is some description on what is part of the data and what is part of the metadata. Governments usually send official documents with a PDF that contains a certificate.</p><img src="https://img.foopi.top/img/loading.gif" data-lazy-src="https://img.foopi.top/postpic/image-20210530145906704.webp" alt="image-20210530145906704" style="zoom:50%"><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">$ </span><span class="language-bash"><span class="hljs-built_in">cat</span> private</span> <br>-----BEGIN PRIVATE KEY-----<br>MIIEvgIBADANBgkqhkiG9w0BAQEFAASCBKgwggSkAgEAAoIBAQCCfrb7kcC8GTFhh+bO5UR0R8abZ3zdOG4gSiIDaAZYhg4DE5HDdJ6xAKyt5YhF4SRZrdr2H01J+XaIldViMWJM8avJnUbVCp0nSH7ituwYO+Zof9N0k/C3mG+cl5LU/BdKBgCzFZDRnyVeKZ7dwgwJWOJNdYLzORiWgoevSYVp9ojLyeZp8pbHkqQoQWda+ws75YI1RYETRqLeJGOIXpPmCB6RZpXr2nBhjjCnoxwCiXHKVu6fecapE+dKGuA128b1cgdUHDRL0+zIQXZvt9dXED48z0+uegsIk4HoOzRCdQst1phMYwoZ/OVSELgDrM8xSgPgTrnsI1WafjVVsUX1AgMBAAECggEAOgK2uZMLyRKx/xd5JZSKH98gjUkuGvHREw2hnT4LRCMj634xmGApg6o3GX8mW1pA3JUK98rmgvIhHYruNx6ZAneU1KXULTTws9vofESxI/zM6ruYdwSlSBi91TEUlxYSDFgqy3HU1TsYU4nRE+gFjcozoBeTRSimo5IXW3cllfrW/NZVPyCLDORoAPXb6259hnh7fb5uu6+bbrg3I5HCPwWpmkySktGIwFJRal9k13UHujvfb/Zud4Xp7Oyfp1FBgLwKhZKQDv0H7ZUD82uvdIQ2oeeGk1govAr1qPr31FxzvnVCabfM4M6aRVlAXONhmt2nOh4vEMPHzc7u0NXiaQKBgQD2WQxsR/Spe5+D+/e6nIcwetih1o7IOTDhuvlWWF2/NDmT8H9OK/Uem29ODbWyvMAf/Tq5goDHyxUn4BPt+MKH7/uM7/Bm1rIGoMiLsfwU6oJLAEwjucGvTTo7EY+8TpTnKSyjBWt6JO4VJ3vlOxm7dDIjebLusyATrQVgEfJlLwKBgQCHm5+HweG4GvDQzATP7ur/YyuLGV4XpRQytw5jvb86lOF/kyi30vrr7xx/VmIt+HZKKbp/xNKguUwc+HoV95Fo5nLhyEfNF6obWF9VV0xHtAfeRQRNDsIg9nPi5VsqfhMjsaK6QVdsT9l7+Enxd2cRSy9xQ9o5R7b2xHKou/aGGwKBgQCgP/0c0xIMziZOLTJRalFm8ALMBE6NYOazcHWR/Zm+L7Lk0aV+rImfh204USLJSo+QP6Jb2tD7Jth0QAe23gNtemcgn1S7ER5twVmzxew9ju+C6oadFtEvwAUJN7tQu62RUe9/fJ8VrcBScoTd8Twj/MpA2YHUVSGgqwS8IfCUcQKBgBm+p8jEPDARnUpmkTtQpniZwTiFNmHSy0Tdj/PLoDRk83Ke44oSmeSU3pomMjl8BCkMRwXevgYZZ6PQYI0vFQIPThwjQ85iAb9zRZYUHr02JpBCFhDzDlPnthSLaoVkrgmGvdgSc6BygF2Sw6b9/ilAVt9v/EwHm2q53PK/zIulAoGBAMeLnZXXJWV7XJMc/qDse/dhYEHt9W50cMSndA4WcAADTSWDNQ3ef2TQ+wcZZqeaCa30Kk7yTH8wkm5bWiaL5sXa+hwf3ilspiqkH4zeh402kKyIkHw4xdNPardtKpvAIJAwBrp/avsLcPVQNX6p1yeFknYAzUYYcD7qHrIOPtZC<br>-----END PRIVATE KEY-----<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_">$ </span><span class="language-bash">openssl rsa -<span class="hljs-keyword">in</span> private -pubout &gt; public</span><br><span class="hljs-meta prompt_">$ </span><span class="language-bash"><span class="hljs-built_in">cat</span> public</span> <br>-----BEGIN PUBLIC KEY-----<br>MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAgn62+5HAvBkxYYfmzuVE<br>dEfGm2d83ThuIEoiA2gGWIYOAxORw3SesQCsreWIReEkWa3a9h9NSfl2iJXVYjFi<br>TPGryZ1G1QqdJ0h+4rbsGDvmaH/TdJPwt5hvnJeS1PwXSgYAsxWQ0Z8lXime3cIM<br>CVjiTXWC8zkYloKHr0mFafaIy8nmafKWx5KkKEFnWvsLO+WCNUWBE0ai3iRjiF6T<br>5ggekWaV69pwYY4wp6McAolxylbun3nGqRPnShrgNdvG9XIHVBw0S9PsyEF2b7fX<br>VxA+PM9PrnoLCJOB6Ds0QnULLdaYTGMKGfzlUhC4A6zPMUoD4E657CNVmn41VbFF<br>9QIDAQAB<br>-----END PUBLIC KEY-----<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_">$ </span><span class="language-bash">openssl rsa -<span class="hljs-keyword">in</span> public -pubin -modulus -noout &gt; modulus_pub</span><br><span class="hljs-meta prompt_">$ </span><span class="language-bash"><span class="hljs-built_in">cat</span> modulus_pub</span> <br>Modulus=827EB6FB91C0BC19316187E6CEE5447447C69B677CDD386E204A2203680658860E031391C3749EB100ACADE58845E12459ADDAF61F4D49F9768895D56231624CF1ABC99D46D50A9D27487EE2B6EC183BE6687FD37493F0B7986F9C9792D4FC174A0600B31590D19F255E299EDDC20C0958E24D7582F33918968287AF498569F688CBC9E669F296C792A42841675AFB0B3BE5823545811346A2DE2463885E93E6081E916695EBDA70618E30A7A31C028971CA56EE9F79C6A913E74A1AE035DBC6F57207541C344BD3ECC841766FB7D757103E3CCF4FAE7A0B089381E83B3442750B2DD6984C630A19FCE55210B803ACCF314A03E04EB9EC23559A7E3555B145F5<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_">$ </span><span class="language-bash"><span class="hljs-built_in">echo</span> -n <span class="hljs-string">&quot;827EB6FB91C0BC19316187E6CEE5447447C69B677CDD386E204A2203680658860E031391C3749EB100ACADE58845E12459ADDAF61F4D49F9768895D56231624CF1ABC99D46D50A9D27487EE2B6EC183BE6687FD37493F0B7986F9C9792D4FC174A0600B31590D19F255E299EDDC20C0958E24D7582F33918968287AF498569F688CBC9E669F296C792A42841675AFB0B3BE5823545811346A2DE2463885E93E6081E916695EBDA70618E30A7A31C028971CA56EE9F79C6A913E74A1AE035DBC6F57207541C344BD3ECC841766FB7D757103E3CCF4FAE7A0B089381E83B3442750B2DD6984C630A19FCE55210B803ACCF314A03E04EB9EC23559A7E3555B145F5&quot;</span> | openssl dgst -sign private -sha256 | <span class="hljs-built_in">base64</span> &gt; tmp</span><br><span class="hljs-meta prompt_">$ </span><span class="language-bash"><span class="hljs-built_in">cat</span> tmp</span> <br>G4fvlou0CBkK7mg0VmMlDux/p71UDZKEhEIVU1nMgbqUH5gDXHnM+CWnG7iKfKLQYzF0Bx9s4fLv<br>VcDCcGc7H9LMx5LpcEkTC30dmKc3uhBN18sdWUl4BaYD4xQkZKlmkc084yccIxtE4RSBe3tDKdkK<br>Xz35W/FGI9xmea0IJleG7xpUiwRX1ClI8nWhS4O2MWMaXGnwwcmnli0XXpsqKurUy44Cim8RCje+<br>4tnWQqoeEKRKxmvk9k6gEgt5QXjon37BJykyGI+p+XEXLNVHUY8aFEOm3ogkYq1kGzk9u30NhdRk<br>umGHQOISafbHP+z07+WjS0cL3oM8rMdpp9QmMQ==<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_">$ </span><span class="language-bash">python</span><br>Python 3.8.10 (default, May 4 2021, 00:00:00) <br>[GCC 10.2.1 20201125 (Red Hat 10.2.1-9)] on linux<br>Type &quot;help&quot;, &quot;copyright&quot;, &quot;credits&quot; or &quot;license&quot; for more information.<br><span class="hljs-meta prompt_">&gt;</span><span class="language-bash">&gt;&gt; with open(<span class="hljs-string">&#x27;tmp&#x27;</span>,<span class="hljs-string">&#x27;r&#x27;</span>) as f: tmp = f.readlines()</span><br><span class="hljs-meta prompt_">&gt;</span><span class="language-bash">&gt;&gt; tmp</span><br>[&#x27;G4fvlou0CBkK7mg0VmMlDux/p71UDZKEhEIVU1nMgbqUH5gDXHnM+CWnG7iKfKLQYzF0Bx9s4fLv\n&#x27;, &#x27;VcDCcGc7H9LMx5LpcEkTC30dmKc3uhBN18sdWUl4BaYD4xQkZKlmkc084yccIxtE4RSBe3tDKdkK\n&#x27;, &#x27;Xz35W/FGI9xmea0IJleG7xpUiwRX1ClI8nWhS4O2MWMaXGnwwcmnli0XXpsqKurUy44Cim8RCje+\n&#x27;, &#x27;4tnWQqoeEKRKxmvk9k6gEgt5QXjon37BJykyGI+p+XEXLNVHUY8aFEOm3ogkYq1kGzk9u30NhdRk\n&#x27;, &#x27;umGHQOISafbHP+z07+WjS0cL3oM8rMdpp9QmMQ==\n&#x27;]<br><span class="hljs-meta prompt_">&gt;</span><span class="language-bash">&gt;&gt; <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;&#x27;</span>.<span class="hljs-built_in">join</span>(tmp).replace(<span class="hljs-string">&#x27;\n&#x27;</span>,<span class="hljs-string">&#x27;&#x27;</span>))</span><br>G4fvlou0CBkK7mg0VmMlDux/p71UDZKEhEIVU1nMgbqUH5gDXHnM+CWnG7iKfKLQYzF0Bx9s4fLvVcDCcGc7H9LMx5LpcEkTC30dmKc3uhBN18sdWUl4BaYD4xQkZKlmkc084yccIxtE4RSBe3tDKdkKXz35W/FGI9xmea0IJleG7xpUiwRX1ClI8nWhS4O2MWMaXGnwwcmnli0XXpsqKurUy44Cim8RCje+4tnWQqoeEKRKxmvk9k6gEgt5QXjon37BJykyGI+p+XEXLNVHUY8aFEOm3ogkYq1kGzk9u30NhdRkumGHQOISafbHP+z07+WjS0cL3oM8rMdpp9QmMQ==<br></code></pre></td></tr></table></figure><h4 id="Keystores">Keystores</h4><p>A keystore is a place where you store keys. Besides <strong>keystore</strong> the term <strong>truststore</strong> is also used frequently. A truststore is the same thing as a keystore. Only it usually contains only the certificates (so basically only public keys and issuer information) of trusted certificates or certificate authorities.</p><h5 id="File-based-keystores">File based keystores</h5><p>A file based keystore is something that in the end has the keys on a file system. Storing public certificates in a file based keystore is very common.</p><h5 id="Database-keystores">Database keystores</h5><p>Keys and especially public certificates can of course also be stored in a database.</p><h5 id="Hardware-keystore">Hardware keystore</h5><p>A hardware keystore is a system that has some sort of hardware which contain the actual keys. This is typically done in high end security environments where the private key is really private. In comparison with file based or database keystores, it is impossible to make a copy of the keystore to send it to some unknown and untrusted environment.</p><p>Some certificate authorities that are used to provide you with a server certificate for your website, also create the private keys for you (as-a-service). However, it is by definition no longer considered a private key. For all keystore types, you should keep the private key private and use a certificate signing request to order your signing or server certificates.</p><h5 id="Managed-keystores-in-operating-system-browser-and-other-applications">Managed keystores in operating system, browser and other applications</h5><p>When you visit a website and your browser says that the certificates are fine, it means that the certificate used for the website is issued by a trusted certificate authority. But this list of trusted certificate authorites is managed. Some CA’s might be revoked or removed. These updates happen in the background when browser updates are installed. Not only the browser maitains a list of trusted certificate authorities, the operation system does so as well. And the Java runtime also has its own list which is kept in the cacerts file. Updates of the OS and Java JRE keep this list up to date. In coporate environments, these are usually maintained by the company and also contain company root certificates.</p><h5 id="Extra-check-for-website-certificates-using-DNS-CAA-records">Extra check for website certificates using DNS CAA records</h5><p>Some companies inspect all or most internet traffic. Even the ones were you think you have an end-2-end secured connection. This works as follows. An employee opens a browser and googles some information. The browser will use https and go to the site of google. The link looks real and the lock is shown in the browser. However, if you would inspect the certificate, you might notice that it has been issued by one of your companies root CA’s! So you have established an end-2-end secure connection with a server of your company, and that server has the secure connection with google. In order to prevent such man in the middle connections to your server, modern browsers now will also check the DNS CAA records to see whether or not a certain issuer is allowed for a certain website. More information: <a target="_blank" rel="noopener external nofollow noreferrer" href="https://en.wikipedia.org/wiki/DNS_Certification_Authority_Authorization">Wiki DNS CAA</a></p><h5 id="Free-certificates-from-Let’s-encrypt">Free certificates from Let’s encrypt</h5><p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://letsencrypt.org">Let’s encrypt</a> is a free, automated and open Certificate Authority. It allows you to create valid certificates for the websites that you control. By following and implementing a certain protocol, your identity is checked and a certificate will be issued. The certificates are free of charge and this is done to stimulate the use of authorised certificates and to lower the use of self-signed certificates on the internet. Certificates are valid for 90 days, so they need to be automatically renewed. (Which makes sure that the proof of identity/ownership also takes place frequently)</p><h4 id="Security-defaults-安全默认配置">Security defaults 安全默认配置</h4><p>A big problem in all kinds of systems is the use of default configurations. E.g. default username/passwords in routers, default passwords for keystores, default unencrypted mode, etc.</p><h5 id="Java-cacerts">Java cacerts</h5><p>Did you ever <strong>changeit</strong>? Putting a password on the cacerts file has some implications. It is important when the trusted certificate authorities need to be protected and an unknown self signed certificate authority cannot be added too easily.</p><h5 id="Protecting-your-id-rsa-private-key">Protecting your id_rsa private key</h5><p>Are you using an ssh key for GitHub and or other sites and are you leaving it unencrypted on your disk? Or even on your cloud drive? By default, the generation of an ssh key pair leaves the private key unencrypted. Which makes it easy to use and if stored in a place where only you can go, it offers sufficient protection. However, it is better to encrypt the key. When you want to use the key, you would have to provide the password again.</p><h5 id="SSH-username-password-to-your-server">SSH username/password to your server</h5><p>When you are getting a virtual server from some hosting provider, there are usually a lot of not so secure defaults. One of which is that ssh to the server runs on the default port 22 and allows username/password attempts. One of the first things you should do, is to change the configuration that you cannot ssh as user root, and you cannot ssh using username/password, but only with a valid and strong ssh key. If not, then you will notice continuous brute force attempts to login to your server.</p><img src="https://img.foopi.top/img/loading.gif" data-lazy-src="https://img.foopi.top/postpic/image-20210530160817646.webp" alt="image-20210530160817646" style="zoom:50%"> <img src="https://img.foopi.top/img/loading.gif" data-lazy-src="https://img.foopi.top/postpic/image-20210530161427774.webp" alt="image-20210530161427774" style="zoom:50%"><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">$ </span><span class="language-bash">docker run --name secret webgoat/assignments:findthesecret -d</span><br><span class="hljs-meta prompt_">$ </span><span class="language-bash">docker <span class="hljs-built_in">exec</span> -it secret bash</span><br>webgoat@90f7ab090b01:/$ ls<br>bin boot dev docker-java-home etc home lib lib64 media mnt opt proc root run sbin srv sys tmp usr var<br>webgoat@90f7ab090b01:/$ cd /root<br>bash: cd: /root: Permission denied<br>webgoat@90f7ab090b01:/$ exit<br></code></pre></td></tr></table></figure><p>求助万能的网络，找到的解法是在容器外修改<code>/etc/shadow</code>内<code>root</code>用户对应的密码。</p><p>图书馆四楼大厅真的热，稍有烦躁，自行尝试了偏方：无密码登陆，居然成了。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">$ </span><span class="language-bash">docker <span class="hljs-built_in">cp</span> secret:/etc/shadow .</span><br><span class="hljs-meta prompt_">$ </span><span class="language-bash">vim shadow</span> <br>root::17918:0:99999:7:::			#去掉 root:*:17918:0:99999:7::: 中密码列的星号<br>daemon:*:17918:0:99999:7:::			#省略<br><span class="hljs-meta prompt_">$ </span><span class="language-bash">docker <span class="hljs-built_in">cp</span> ./shadow secret:/etc/shadow</span><br><span class="hljs-meta prompt_">$ </span><span class="language-bash">docker <span class="hljs-built_in">exec</span> -it secret bash</span><br>webgoat@90f7ab090b01:/$ cd /root<br>bash: cd: /root: Permission denied<br>webgoat@90f7ab090b01:/$ sudo cd /root<br>bash: sudo: command not found<br>webgoat@90f7ab090b01:/$ su<br>root@90f7ab090b01:/# cd /root<br>root@90f7ab090b01:~# ls<br>default_secret<br>root@90f7ab090b01:~# cat default_secret <br>ThisIsMySecretPassw0rdF0rY0u<br>root@90f7ab090b01:~# echo &quot;U2FsdGVkX199jgh5oANElFdtCxIEvdEvciLi+v+5loE+VCuy6Ii0b+5byb5DXp32RPmT02Ek1pf55ctQN+DHbwCPiVRfFQamDmbHBUpD7as=&quot; | openssl enc -aes-256-cbc -d -a -kfile default_secret <br>Leaving passwords in docker images is not so secure<br></code></pre></td></tr></table></figure><h4 id="Post-quantum-crypto">Post quantum crypto</h4><p>Quantum computers are here and getting more power in available qubits each year. Quantum computers are and will be capable of decrypting information that was encrypted with algorithms that were thought to be safe. For some years now, a lot of encrypted communicatation using quantum vulnerable cryptoraphy is being recorded. This information will be decrypted when the quantum computers are powerful enough. Even tough the information may be old, it still could contain valuable information that can be misused. Besides the fact that some private information will be known to parties it was not intended for.</p><p>Mathematics has answers for the post quantum era. New cryptography is already available and should be used NOW in order to minimize threads. You can read more on this on Wikipedia <a target="_blank" rel="noopener external nofollow noreferrer" href="https://en.wikipedia.org/wiki/Post-quantum_cryptography">Post quatum on Wikipedia</a></p></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者:</span> <span class="post-copyright-info"><a href="mailto:undefined" rel="external nofollow noreferrer">Foo</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接:</span> <span class="post-copyright-info"><a href="https://foopi.top/posts/4cfedd8d/">https://foopi.top/posts/4cfedd8d/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明:</span> <span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="external nofollow noreferrer" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://foopi.top" target="_blank">Time of Pi</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/WebGoat/">WebGoat</a></div><div class="post_share"></div></div><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/posts/f6ab3c74/" title="WebGoat实战: Injection"><img class="cover" src="https://img.foopi.top/img/loading.gif" data-lazy-src="https://img.foopi.top/cover/nicebrain.webp" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-06-01</div><div class="title">WebGoat实战: Injection</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://img.foopi.top/img/loading.gif" data-lazy-src="https://img.foopi.top/img/avatar.webp" onerror='this.onerror=null,this.src="/img/friend_404.gif"' alt="avatar"></div><div class="author-info__name">Foo</div><div class="author-info__description"></div></div><div class="card-info-data is-center"><div class="card-info-data-item"><a href="/archives/"><div class="headline">文章</div><div class="length-num">28</div></a></div><div class="card-info-data-item"><a href="/tags/"><div class="headline">标签</div><div class="length-num">11</div></a></div><div class="card-info-data-item"><a href="/categories/"><div class="headline">分类</div><div class="length-num">12</div></a></div></div><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/lucifer9735" rel="external nofollow noreferrer" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:lucifer9735@gmail.com" rel="external nofollow noreferrer" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">欢迎来访，喜欢请收藏w</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA"><span class="toc-number">1.</span> <span class="toc-text">环境搭建</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%89%E8%A3%85-docker"><span class="toc-number">1.1.</span> <span class="toc-text">安装 docker</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9B%B4%E6%8D%A2-docker-%E6%BA%90"><span class="toc-number">1.2.</span> <span class="toc-text">更换 docker 源</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B5%8B%E8%AF%95-hello-world"><span class="toc-number">1.3.</span> <span class="toc-text">测试 hello-world</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%AF%E8%83%BD%E9%9C%80%E8%A6%81%E7%9A%84%E8%AE%BE%E7%BD%AE"><span class="toc-number">1.4.</span> <span class="toc-text">可能需要的设置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#WebGoat-%E7%9B%B8%E5%85%B3%E5%91%BD%E4%BB%A4"><span class="toc-number">1.5.</span> <span class="toc-text">WebGoat 相关命令</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Introduction"><span class="toc-number">2.</span> <span class="toc-text">Introduction</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#WebGoat"><span class="toc-number">2.1.</span> <span class="toc-text">WebGoat</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#WebWolf"><span class="toc-number">2.2.</span> <span class="toc-text">WebWolf</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#General"><span class="toc-number">3.</span> <span class="toc-text">General</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#HTTP-Basics"><span class="toc-number">3.1.</span> <span class="toc-text">HTTP Basics</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#HTTP-Proxies"><span class="toc-number">3.2.</span> <span class="toc-text">HTTP Proxies</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Developer-Tools"><span class="toc-number">3.3.</span> <span class="toc-text">Developer Tools</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CIA-Triad"><span class="toc-number">3.4.</span> <span class="toc-text">CIA Triad</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Confidentiality-%E6%9C%BA%E5%AF%86%E6%80%A7"><span class="toc-number">3.4.1.</span> <span class="toc-text">Confidentiality 机密性</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Integrity-%E5%AE%8C%E6%95%B4%E6%80%A7"><span class="toc-number">3.4.2.</span> <span class="toc-text">Integrity 完整性</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Availability-%E5%8F%AF%E7%94%A8%E6%80%A7"><span class="toc-number">3.4.3.</span> <span class="toc-text">Availability 可用性</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Crypto-Basics"><span class="toc-number">3.5.</span> <span class="toc-text">Crypto Basics</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Encoding-%E7%BC%96%E7%A0%81"><span class="toc-number">3.5.1.</span> <span class="toc-text">Encoding 编码</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#Base64-Encoding"><span class="toc-number">3.5.1.1.</span> <span class="toc-text">Base64 Encoding</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Basic-Authentication"><span class="toc-number">3.5.1.2.</span> <span class="toc-text">Basic Authentication</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#HTML-encoding"><span class="toc-number">3.5.1.3.</span> <span class="toc-text">HTML encoding</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#UUEncode"><span class="toc-number">3.5.1.4.</span> <span class="toc-text">UUEncode</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#XOR-encoding"><span class="toc-number">3.5.1.5.</span> <span class="toc-text">XOR encoding</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Hashing-%E5%93%88%E5%B8%8C%E6%95%A3%E5%88%97"><span class="toc-number">3.5.2.</span> <span class="toc-text">Hashing 哈希散列</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#Plain-Hashing"><span class="toc-number">3.5.2.1.</span> <span class="toc-text">Plain Hashing</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Salted-Hashes"><span class="toc-number">3.5.2.2.</span> <span class="toc-text">Salted Hashes</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Encryption-%E5%8A%A0%E5%AF%86"><span class="toc-number">3.5.3.</span> <span class="toc-text">Encryption 加密</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#HTTPS-uses-both-symmetric-and-asymmetric-keys"><span class="toc-number">3.5.3.1.</span> <span class="toc-text">HTTPS uses both symmetric and asymmetric keys</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Signing-%E7%AD%BE%E5%90%8D"><span class="toc-number">3.5.4.</span> <span class="toc-text">Signing 签名</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#RAW-signatures"><span class="toc-number">3.5.4.1.</span> <span class="toc-text">RAW signatures</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#CMS-signatures"><span class="toc-number">3.5.4.2.</span> <span class="toc-text">CMS signatures</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#SOAP-signatures"><span class="toc-number">3.5.4.3.</span> <span class="toc-text">SOAP signatures</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Email-signatures"><span class="toc-number">3.5.4.4.</span> <span class="toc-text">Email signatures</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#PDF-or-Word-or-other-signatures"><span class="toc-number">3.5.4.5.</span> <span class="toc-text">PDF or Word or other signatures</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Keystores"><span class="toc-number">3.5.5.</span> <span class="toc-text">Keystores</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#File-based-keystores"><span class="toc-number">3.5.5.1.</span> <span class="toc-text">File based keystores</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Database-keystores"><span class="toc-number">3.5.5.2.</span> <span class="toc-text">Database keystores</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Hardware-keystore"><span class="toc-number">3.5.5.3.</span> <span class="toc-text">Hardware keystore</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Managed-keystores-in-operating-system-browser-and-other-applications"><span class="toc-number">3.5.5.4.</span> <span class="toc-text">Managed keystores in operating system, browser and other applications</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Extra-check-for-website-certificates-using-DNS-CAA-records"><span class="toc-number">3.5.5.5.</span> <span class="toc-text">Extra check for website certificates using DNS CAA records</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Free-certificates-from-Let%E2%80%99s-encrypt"><span class="toc-number">3.5.5.6.</span> <span class="toc-text">Free certificates from Let’s encrypt</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Security-defaults-%E5%AE%89%E5%85%A8%E9%BB%98%E8%AE%A4%E9%85%8D%E7%BD%AE"><span class="toc-number">3.5.6.</span> <span class="toc-text">Security defaults 安全默认配置</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#Java-cacerts"><span class="toc-number">3.5.6.1.</span> <span class="toc-text">Java cacerts</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Protecting-your-id-rsa-private-key"><span class="toc-number">3.5.6.2.</span> <span class="toc-text">Protecting your id_rsa private key</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#SSH-username-password-to-your-server"><span class="toc-number">3.5.6.3.</span> <span class="toc-text">SSH username&#x2F;password to your server</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Post-quantum-crypto"><span class="toc-number">3.5.7.</span> <span class="toc-text">Post quantum crypto</span></a></li></ol></li></ol></li></ol></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2021 - 2022 By Foo</div><div class="framework-info"><span>框架</span> <a target="_blank" rel="noopener external nofollow noreferrer" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题</span> <a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><script>var preloader={endLoading:()=>{document.body.style.overflow="auto",document.getElementById("loading-box").classList.add("loaded")},initLoading:()=>{document.body.style.overflow="",document.getElementById("loading-box").classList.remove("loaded")}};window.addEventListener("load",preloader.endLoading())</script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>