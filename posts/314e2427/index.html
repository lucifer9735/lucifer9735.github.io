<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"><title>Vigenere维吉尼亚密码加解密及唯密文攻击 | Time of Pi</title><meta name="keywords" content="python"><meta name="author" content="Foo"><meta name="copyright" content="Foo"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="实验报告"><meta property="og:type" content="article"><meta property="og:title" content="Vigenere维吉尼亚密码加解密及唯密文攻击"><meta property="og:url" content="https://foopi.top/posts/314e2427/index.html"><meta property="og:site_name" content="Time of Pi"><meta property="og:description" content="实验报告"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://img.foopi.top/cover/miss.webp"><meta property="article:published_time" content="2021-05-14T05:51:36.000Z"><meta property="article:modified_time" content="2022-04-03T06:25:02.041Z"><meta property="article:author" content="Foo"><meta property="article:tag" content="python"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://img.foopi.top/cover/miss.webp"><link rel="shortcut icon" href="https://img.foopi.top/img/favicon.webp"><link rel="canonical" href="https://foopi.top/posts/314e2427/"><link rel="preconnect" href="//cdn.jsdelivr.net"><link rel="preconnect" href="//static.cloudflareinsights.com"><link rel="preconnect" href="//busuanzi.ibruce.info"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6/css/all.min.css" media="print" onload='this.media="all"'><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css" media="print" onload='this.media="all"'><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.css" media="print" onload='this.media="all"'><script defer data-pjax="data-pjax" src="https://static.cloudflareinsights.com/beacon.min.js" data-cf-beacon="{&quot;token&quot;: &quot;1167d76d896d415ebda0de73b6b5f2e8&quot;}"></script><script>const GLOBAL_CONFIG={root:"/",algolia:void 0,localSearch:void 0,translate:void 0,noticeOutdate:void 0,highlight:{plugin:"highlighjs",highlightCopy:!0,highlightLang:!0,highlightHeightLimit:192},copy:{success:"复制成功",error:"复制错误",noSupport:"浏览器不支持"},relativeDate:{homepage:!1,post:!0},runtime:"天",date_suffix:{just:"刚刚",min:"分钟前",hour:"小时前",day:"天前",month:"个月前"},copyright:void 0,lightbox:"fancybox",Snackbar:{chs_to_cht:"你已切换为繁体",cht_to_chs:"你已切换为简体",day_to_night:"你已切换为深色模式",night_to_day:"你已切换为浅色模式",bgLight:"#49b1f5",bgDark:"#121212",position:"bottom-left"},source:{justifiedGallery:{js:"https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.js",css:"https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.css"}},isPhotoFigcaption:!1,islazyload:!0,isAnchor:!0}</script><script id="config-diff">var GLOBAL_CONFIG_SITE={title:"Vigenere维吉尼亚密码加解密及唯密文攻击",isPost:!0,isHome:!1,isHighlightShrink:!1,isToc:!0,postUpdate:"2022-04-03 14:25:02"}</script><noscript><style>#nav{opacity:1}.justified-gallery img{opacity:1}#post-meta time,#recent-posts time{display:inline!important}</style></noscript><script>(e=>{e.saveToLocal={set:function(e,t,o){if(0===o)return;const n=864e5*o,a={value:t,expiry:(new Date).getTime()+n};localStorage.setItem(e,JSON.stringify(a))},get:function(e){const t=localStorage.getItem(e);if(!t)return;const o=JSON.parse(t);if(!((new Date).getTime()>o.expiry))return o.value;localStorage.removeItem(e)}},e.getScript=e=>new Promise((t,o)=>{const n=document.createElement("script");n.src=e,n.async=!0,n.onerror=o,n.onload=n.onreadystatechange=function(){const e=this.readyState;e&&"loaded"!==e&&"complete"!==e||(n.onload=n.onreadystatechange=null,t())},document.head.appendChild(n)}),e.activateDarkMode=function(){document.documentElement.setAttribute("data-theme","dark"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","#0d0d0d")},e.activateLightMode=function(){document.documentElement.setAttribute("data-theme","light"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","#ffffff")};const t=saveToLocal.get("theme");"dark"===t?activateDarkMode():"light"===t&&activateLightMode();const o=saveToLocal.get("aside-status");void 0!==o&&("hide"===o?document.documentElement.classList.add("hide-aside"):document.documentElement.classList.remove("hide-aside"));/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)&&document.documentElement.classList.add("apple")})(window)</script><meta name="generator" content="Hexo 5.4.1"></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">加载中...</div></div></div><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://img.foopi.top/img/loading.gif" data-lazy-src="https://img.foopi.top/img/avatar.webp" onerror='onerror=null,src="/img/friend_404.gif"' alt="avatar"></div><div class="site-data is-center"><div class="data-item"><a href="/archives/"><div class="headline">文章</div><div class="length-num">28</div></a></div><div class="data-item"><a href="/tags/"><div class="headline">标签</div><div class="length-num">11</div></a></div><div class="data-item"><a href="/categories/"><div class="headline">分类</div><div class="length-num">12</div></a></div></div><hr><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i> <span>Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i> <span>Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i> <span>Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i> <span>Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i> <span>links</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image:url(https://img.foopi.top/cover/miss.webp)"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">Time of Pi</a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i> <span>Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i> <span>Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i> <span>Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i> <span>Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i> <span>links</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">Vigenere维吉尼亚密码加解密及唯密文攻击</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2021-05-14T05:51:36.000Z" title="发表于 2021-05-14 13:51:36">2021-05-14</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2022-04-03T06:25:02.041Z" title="更新于 2022-04-03 14:25:02">2022-04-03</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E6%83%B3%E8%A6%81%E6%AF%95%E4%B8%9A/">想要毕业</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E6%83%B3%E8%A6%81%E6%AF%95%E4%B8%9A/%E5%AF%86%E7%A0%81%E5%AD%A6%E8%BF%9B%E5%B1%95/">密码学进展</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">5.1k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>22分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" data-flag-title="Vigenere维吉尼亚密码加解密及唯密文攻击"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><p>代码详见 <a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/lucifer9735/vigenere"><strong>vigenere</strong></a></p><blockquote></blockquote><h2 id="实验目的">实验目的</h2><ol><li>掌握Python语言中的字符串，列表，字典，元组的使用;</li><li>熟练Python语言中的条件语句和循环语句;</li><li>掌握Python语言中函数的定义和使用;</li><li>理解维吉尼亚密码加解密过程;</li><li>理解卡西斯基试验以及如何进行频率分析。</li></ol><h2 id="实验内容">实验内容</h2><ol><li>编程实现维吉尼亚密码加解密过程。</li><li>破解输入的维吉尼亚密文。</li></ol><h2 id="实验原理和步骤">实验原理和步骤</h2><p>维吉尼亚密码是使用一系列凯撒密码组成密码字母表的加密算法，属于多表密码的一种简单形式。</p><p>为了生成密码，需要使用表格法。这一表格包括了26行字母表，每一行都由前一行向左偏移一位得到。 具体使用哪一行字母表进行编译是基于密钥进行的，在过程中会不断地变换。</p><p>表格中，第一行代表原文的字母，下面每一横行代表原文分别由哪些字母代替(也就是说每一行代表一 套凯撒密码加密方法)，每一竖列代表我们要用第几套字符来替换原文。一共26个字母，26套代替法， 所以这个表是一个26*26的表。</p><img src="https://img.foopi.top/img/loading.gif" data-lazy-src="https://img.foopi.top/postpic/Vigenère_square.svg" alt="Vigenère_square" style="zoom:50%"><h2 id="第一部分-维吉尼亚密码加解密">第一部分:维吉尼亚密码加解密</h2><p>明文:“Common sense is not so common.”</p><p>密钥:“PIZZA”</p><p>密文:“Rwlloc admst qr moi an bobunm.”</p><p>说明:表格中的字母都是大写，在输入输出时可以进行大小写转换，使得加解密前后明文和密文相同位置的字母大小写一致。</p><h3 id="编码实现维吉尼亚密码加解密过程">编码实现维吉尼亚密码加解密过程</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># 维吉尼亚密码加解密过程</span><br><span class="hljs-keyword">import</span> string<br><span class="hljs-keyword">from</span> itertools <span class="hljs-keyword">import</span> cycle<br><span class="hljs-comment"># 代码写在这里</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">encrypt</span>(<span class="hljs-params">message, key</span>):<br>    tmp_text = <span class="hljs-string">&#x27;&#x27;</span><br>    keylen = <span class="hljs-built_in">len</span>(key)<br>    tmp_key = key.upper()<br>    i = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> message:<br>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> c.isalpha():<br>            tmp_text += c<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-keyword">if</span> c.isupper(): a = <span class="hljs-string">&#x27;A&#x27;</span><br>            <span class="hljs-keyword">else</span>: a = <span class="hljs-string">&#x27;a&#x27;</span><br>            tmp_text += <span class="hljs-built_in">chr</span>(<span class="hljs-built_in">ord</span>(a)+((<span class="hljs-built_in">ord</span>(c)-<span class="hljs-built_in">ord</span>(a)) + (<span class="hljs-built_in">ord</span>(tmp_key[i])-<span class="hljs-built_in">ord</span>(<span class="hljs-string">&#x27;A&#x27;</span>)))% <span class="hljs-number">26</span>)<br>            i += <span class="hljs-number">1</span><br>            <span class="hljs-keyword">if</span> i == keylen: i = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">return</span> tmp_text<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">decrypt</span>(<span class="hljs-params">message, key</span>):<br>    tmp_text = <span class="hljs-string">&#x27;&#x27;</span><br>    keylen = <span class="hljs-built_in">len</span>(key)<br>    tmp_key = key.upper()<br>    i = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> message:<br>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> c.isalpha():<br>            tmp_text += c<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-keyword">if</span> c.isupper(): a = <span class="hljs-string">&#x27;A&#x27;</span><br>            <span class="hljs-keyword">else</span>: a = <span class="hljs-string">&#x27;a&#x27;</span><br>            tmp_text += <span class="hljs-built_in">chr</span>(<span class="hljs-built_in">ord</span>(a)+((<span class="hljs-built_in">ord</span>(c)-<span class="hljs-built_in">ord</span>(a)) - (<span class="hljs-built_in">ord</span>(tmp_key[i])-<span class="hljs-built_in">ord</span>(<span class="hljs-string">&#x27;A&#x27;</span>)))% <span class="hljs-number">26</span>)<br>            i += <span class="hljs-number">1</span><br>            <span class="hljs-keyword">if</span> i == keylen: i = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">return</span> tmp_text<br><br><span class="hljs-comment"># 测试</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():<br>    message = <span class="hljs-string">&#x27;Common sense is not so common.&#x27;</span><br>    key = <span class="hljs-string">&#x27;PIZZA&#x27;</span><br><br>    cipher_text = encrypt(message, key)<br>    decrypted_text = decrypt(cipher_text, key)<br><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;加密前的文本是:&quot;</span>, message)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;加密后的文本是:&quot;</span>, cipher_text)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;解密后的文本是:&quot;</span>, decrypted_text)<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    main()<br></code></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">加密前的文本是: Common sense is not so common.<br>加密后的文本是: Rwlloc admst qr moi an bobunm.<br>解密后的文本是: Common sense is not so common.<br></code></pre></td></tr></table></figure><h2 id="第二部分-维吉尼亚唯密文攻击">第二部分:维吉尼亚唯密文攻击</h2><p>明文中相同字符加密后可能为不同字符;真实情况下，只有密文，没有密钥，怎么破解维吉尼亚密码呢?</p><h3 id="卡西斯基试验-Kasiski-Examination">卡西斯基试验(Kasiski Examination)</h3><p>Charles Babbage被认为破解了维吉尼亚密码，但是他没有公布结果。后来他的方法被20世纪初期的数学家卡西斯基公布出来，所以该方法就叫做卡西斯基试验。</p><p>在破解维吉尼亚密文时，我们不知道密钥长度。但是，我们知道其实密钥也就一个，密钥像滑窗一样进行加密。由于英文有很多重复的单词，比如the等等，这时候如果我们在一串密文中发现两段相同的字符 串，两者之间的距离很有可能就是密钥的长度。我们多发现几段相同的字符串，求它们之间间隔的<strong>因数</strong> 就可以大致确定密钥长度。知道密钥长度之后，维吉尼亚密码退化成为一个移位密码，可以用破解凯撒 密码的方式去破解它。</p><h4 id="从密文中找出拼写完全相同的字符串-数这些相同的字符串中间间隔的字母数">从密文中找出拼写完全相同的字符串;数这些相同的字符串中间间隔的字母数</h4><p>举例:</p><ul><li><strong>密文如下</strong>:“Ppqca xqvekg ybnkmazu ybngbal jon i tszm jyim. Vrag voht vrau c tksg. Ddwuo xitlazu vavv raz c vkb qp iwpou.”</li><li><strong>移除非字母字符并转换为大写之后</strong>，得到 PPQCAXQVEKGYBNKMAZUYBNGBALJONITSZMJYIMVRAGVOHTVRAUCTKSGDDWUOXITLAZUV AVVRAZCVKBQPIWPOU</li><li>发现<strong>VRA</strong>, <strong>AZU</strong>, and <strong>YBN</strong> 是重复序列</li><li>PPQCAXQVEKGYBNKMAZUYBNGBALJONITSZMJYIM<strong>VRA</strong>GVOHT<strong>VRA</strong>UCTKSGDDWUOXITLAZUVAV<strong>VRA</strong>ZCVKBQPIWPOU</li><li>PPQCAXQVEKGYBNKM<strong>AZU</strong>YBNGBALJONITSZMJYIMVRAGVOHTVRAUCTKSGDDWUOXITL<strong>AZU</strong>VAVVRAZCVKBQPIWPOU</li><li>PPQCAXQVEKG<strong>YBN</strong>KMAZU<strong>YBN</strong>GBALJONITSZMJYIMVRAGVOHTVRAUCTKSGDDWUOXITLAZUVAVVRAZCVKBQPIWPOU</li><li><strong>找到序列之间的间距</strong>:<ul><li>第一个和第二个 VRA 序列之间间隔8个字母;</li><li>第二个和第三个 VRA 序列之间间隔24个字母;</li><li>第一个和第三个 VRA 序列之间间隔32个字母;</li><li>第一个和第二个 AZU 序列之间间隔48个字母;</li><li>第一个和第二个 YBN 序列之间间隔8个字母。</li></ul></li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">find_repeat_sequences_spacings</span>(<span class="hljs-params">message</span>):<br>    <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">    参数:message，是一个字符串</span><br><span class="hljs-string">    功能:遍历message，找到3到5个字母长度的重复序列</span><br><span class="hljs-string">    返回值:一个字典，键是序列，值是序列间隔列表(重复序列之间间隔的字母数)</span><br><span class="hljs-string">    &quot;&quot;&quot;</span><br>    <span class="hljs-comment"># 代码如下  </span><br>    <span class="hljs-comment"># 预处理字符串    </span><br>    tmp_text = pre_treatment(message)<br>    <span class="hljs-comment"># 生成重复序列间隔字典</span><br>    dic = <span class="hljs-built_in">dict</span>()<br>    <span class="hljs-comment"># 查找3-5位字母长度的重复序列</span><br>    <span class="hljs-keyword">for</span> strlen <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>,<span class="hljs-number">6</span>):<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-built_in">len</span>(tmp_text)-<span class="hljs-number">2</span>*strlen+<span class="hljs-number">1</span>):<br>            tmp_str = tmp_text[i:i+strlen]<br>            tmp_count = tmp_text.count(tmp_str)<br>            <span class="hljs-keyword">if</span> tmp_count &gt; <span class="hljs-number">1</span>:<br>                <span class="hljs-keyword">if</span> tmp_str <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> dic.keys():<br>                    last = tmp_text.find(tmp_str)<br>                    find_list = [last]<br>                    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,tmp_count):<br>                        now = tmp_text.find(tmp_str,last+strlen)<br>                        find_list.append(now)<br>                        last = now<br>                    spacing_list = []<br>                    listlen = <span class="hljs-built_in">len</span>(find_list)<br>                    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,listlen-<span class="hljs-number">1</span>):<br>                        <span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(j+<span class="hljs-number">1</span>,listlen):<br>                            spacing_list.append(find_list[k]-find_list[j])<br>                    dic[tmp_str] = spacing_list<br>        <br>    <span class="hljs-keyword">return</span>(dic)   <br></code></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># 测试</span><br>ciphertext = <span class="hljs-string">&quot;Ppqca xqvekg ybnkmazu ybngbal jon i tszm jyim. Vrag voht vrau c tksg. Ddwuo xitlazu vavv raz c vkb qp iwpou.&quot;</span><br><span class="hljs-built_in">print</span>(find_repeat_sequences_spacings(ciphertext))<br></code></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">&#123;&#x27;YBN&#x27;: [8], &#x27;AZU&#x27;: [48], &#x27;VRA&#x27;: [8, 32, 24]&#125;<br></code></pre></td></tr></table></figure><h4 id="找到间隔之间的因数">找到间隔之间的因数</h4><ul><li>8的因数是2,4,8</li><li>24的因数是2,3,4,6,8,12,24</li><li>32的因数是2,4,8,16,32</li><li>48的因数是2,3,4,6,8,12,16,24,48</li></ul><p><strong>次数出现最多的几个因数极有可能就是密钥字符串的长度</strong>，即2,4,8,3,6,12</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_useful_factors</span>(<span class="hljs-params">num</span>):<br>	  <span class="hljs-string">&quot;&quot;&quot;返回num的因子列表&quot;&quot;&quot;</span><br>    factors_list = []<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2</span>,math.isqrt(num)+<span class="hljs-number">1</span>):<br>        <span class="hljs-keyword">if</span> num % i == <span class="hljs-number">0</span>:<br>            factors_list.append(i)<br>            j = num//i<br>            <span class="hljs-keyword">if</span> i != j:<br>                factors_list.append(j)<br>    factors_list.sort()<br>    <br>    <span class="hljs-keyword">return</span>(factors_list)<br></code></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># 测试</span><br><span class="hljs-built_in">print</span>(get_useful_factors(<span class="hljs-number">24</span>))<br></code></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">[2, 3, 4, 6, 8, 12]<br></code></pre></td></tr></table></figure><p>编程计算每个因子出现的次数，按照出现次数从大到小排序，得到一个因子列表，这些因子就是可能的密钥长度</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># 编程找到可能的密钥长度</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_possible_keylen</span>(<span class="hljs-params">message</span>):<br>    tmp_dic = find_repeat_sequences_spacings(message)<br>    dic_fac =  <span class="hljs-built_in">dict</span>()<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> tmp_dic:<br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> tmp_dic[i]:<br>            tmp_fac = get_useful_factors(j)<br>            <span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> tmp_fac:<br>                <span class="hljs-keyword">if</span> k <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> dic_fac:<br>                    dic_fac[k] = <span class="hljs-number">1</span><br>                <span class="hljs-keyword">else</span>:<br>                    dic_fac[k] += <span class="hljs-number">1</span><br>    list_fac = []<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">sorted</span>(dic_fac.items(), key=<span class="hljs-keyword">lambda</span> x:(-x[<span class="hljs-number">1</span>],x[<span class="hljs-number">0</span>])):<br>        <span class="hljs-comment"># print(i)</span><br>        list_fac.append(i[<span class="hljs-number">0</span>])<br>    <br>    <span class="hljs-keyword">return</span>(list_fac)<br></code></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># 测试</span><br>ciphertext = <span class="hljs-string">&#x27;Ppqca xqvekg ybnkmazu ybngbal jon i tszm jyim. Vrag voht vrau c tksg. Ddwuo xitlazu vavv raz c vkb qp iwpou.&#x27;</span><br><span class="hljs-built_in">print</span>(get_possible_keylen(ciphertext))<br></code></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">[2, 4, 8, 3, 6, 12, 16, 24]<br></code></pre></td></tr></table></figure><h4 id="将密文字符串按照密钥长度分组，并获取每组中第N个字母">将密文字符串按照密钥长度分组，并获取每组中第N个字母</h4><p><strong>假设密钥长度为4</strong>，将密文按每4个字母为一组分开, 提取字母:</p><ul><li>从第1个字母开始0,4,8，…,从第2个字母开始1,5,9,…,从第3个字母开始2,6,10,…,从第4个字母开始 3,7,11,…这样提取到4个字符串，对这4个字符串按照破解凯撒加密密文进行频率分析，计算分数。</li><li>如果我们从卡西斯基试验猜测是正确的，那么密钥的第一个字母对明文加密得到的就是第一个字符串;密钥的第二个字母对明文加密得到的就是第二个字符串;以此类推。</li><li>得到的字符串分别为:<ul><li>从第1个字母开始得到:PAEBABANZIAHAKDXAAAKIU</li><li>从第2个字母开始得到:PXKNZNLIMMGTUSWIZVZBW</li><li>从第3个字母开始得到:QQGKUGJTJVVVCGUTUVCQP</li><li>从第4个字母开始得到:CVYMYBOSYRORTDOLVRVPO</li></ul></li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_nth_subkeys_letters</span>(<span class="hljs-params">n,key_length,message</span>):<br>  	<span class="hljs-string">&quot;&quot;&quot;将message按照key_length长度分组，每个分组中第n个字母拿出来</span><br><span class="hljs-string">  	getNthSubkeysLetters(1, 3, &#x27;ABCABCABC&#x27;) returns &#x27;AAA&#x27;</span><br><span class="hljs-string">  	getNthSubkeysLetters(2, 3, &#x27;ABCABCABC&#x27;) returns &#x27;BBB&#x27;</span><br><span class="hljs-string">  	getNthSubkeysLetters(3, 3, &#x27;ABCABCABC&#x27;) returns &#x27;CCC&#x27;</span><br><span class="hljs-string">  	getNthSubkeysLetters(1, 5, &#x27;ABCDEFGHI&#x27;) returns &#x27;AF&#x27;</span><br><span class="hljs-string">  	&quot;&quot;&quot;</span><br>    <span class="hljs-comment"># 预处理字符串    </span><br>    tmp_text = pre_treatment(message)<br>    tmp_str = <span class="hljs-string">&#x27;&#x27;</span><br>    i = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> tmp_text:<br>        <span class="hljs-keyword">if</span> i % key_length == n-<span class="hljs-number">1</span>:<br>            tmp_str += c<br>        i += <span class="hljs-number">1</span><br><br>    <span class="hljs-keyword">return</span>(tmp_str)<br></code></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># 测试</span><br>ciphertext = <span class="hljs-string">&quot;Ppqca xqvekg ybnkmazu ybngbal jon i tszm jyim. Vrag voht vrau ctksg. Ddwuo xitlazu vavv raz c vkb qp iwpou.&quot;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-number">5</span>):<br>    <span class="hljs-built_in">print</span>(get_nth_subkeys_letters(i,<span class="hljs-number">4</span>,ciphertext))<br></code></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">PAEBABANZIAHAKDXAAAKIU<br>PXKNZNLIMMGTUSWIZVZBW<br>QQGKUGJTJVVVCGUTUVCQP<br>CVYMYBOSYRORTDOLVRVPO<br></code></pre></td></tr></table></figure><h4 id="对上面得到的字符串用频率分析破解得到密钥中的每个字母">对上面得到的字符串用频率分析破解得到密钥中的每个字母</h4><p>假设子密钥从26个字母中选取，然后对上面的每个字符串进行解密，并计算分数，选取分数最高的几个，就是可能的子密钥。</p><ul><li>第1个字符串最可能的子密钥是:A, I, N, W</li><li>第2个字符串最可能的子密钥是:I, Z, A, E</li><li>第3个字符串最可能的子密钥是:C, G, H, I</li><li>第4个字符串最可能的子密钥是:K, N, R, V</li></ul><p>然后用暴力破解，对这些子密钥进行组合，共有4<em>4</em>4*4=256种可能性。</p><h5 id="频率分析">频率分析</h5><p>英语字母表有26个字母，但是每个字母在英语文本中出现的频率不一样。按照出现频率从高到低排序为 <strong>ETAOINSHRDLCUMWFGYPBVKJXQZ</strong>。</p><p>在明文和密文中计算字母总数和它们出现的频率称为<strong>频率分析</strong>。</p><p>当我们需要破解维吉尼亚密码时，我们不能再分析单词，因为密文中的单词可能是多个子密钥加密的，相应地我们要分析每个子密钥的加密文本的字母频率。</p><p>我们设置一个频率匹配分数score，初值为0，计算过程如下:</p><ul><li>计算密文中每个字母出现的频率，从高到低排序</li><li>计算前6个字母和后6个字母是否出现在ETAOIN的前6个字母处和后6个字母处</li><li>出现score就加1，这样score取值是0-12。</li></ul><p>一段密文如下:“I rc ascwuiluhnviwuetnh,osgaa ice tipeeeee slnatsfietgi tittynecenisl. e fo f fnc isltn sn o a yrs sd onisli ,l erglei trhfmwfrogotn,l stcofiit.aea wesn,lnc ee w,l eIh eeehoer ros iol er snh nl oahsts ilasvih tvfeh rtira id <a target="_blank" rel="noopener external nofollow noreferrer" href="http://thatnie.im">thatnie.im</a> ei-dlmf i thszonsisehroe, aiehcdsanahiec gv gyedsB affcahiecesd d lee onsdihsoc nin cethiTitx eRneahgin r e teom fbiotd n ntacscwevhtdhnhpiwru”</p><p>统计字母出现频率，从高到低排序如下:EISNTHAOCLRFDGWVMUYBPZXQJK。前6个字母出现了 E,I,N,T, 后6个字母出现了K,J,X,Q,Z, 所以分数是9。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># 英语字母频率</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">freq_match_score</span>(<span class="hljs-params">message</span>):<br>	  <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">	  将message中字符按照频数从高到低排序，</span><br><span class="hljs-string">	  然后查看出现频数最高的前6个字符和出现频数最低的后6个字符</span><br><span class="hljs-string">	  是否与英语字母频数表(ETAOIN)中的字符相匹配。</span><br><span class="hljs-string">	  若匹配，match_score加1</span><br><span class="hljs-string">	  &quot;&quot;&quot;</span><br>    ETAOIN = <span class="hljs-string">&#x27;ETAOINSHRDLCUMWFGYPBVKJXQZ&#x27;</span><br>    match_score = <span class="hljs-number">0</span><br>    tmp_text = pre_treatment(message)<br>    <span class="hljs-comment"># 初始化计数字典并计数</span><br><span class="hljs-comment">#    base = &#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZ&#x27;</span><br><span class="hljs-comment">#    上面这行注释绝妙，无意间解决了ETAOIN排序问题</span><br>    dic_letter_freq = <span class="hljs-built_in">dict</span>()<br>    <span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> ETAOIN:<br>        dic_letter_freq[c] = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> tmp_text:<br>        dic_letter_freq[c] += <span class="hljs-number">1</span><br>    <span class="hljs-comment"># 生成频数字母列表字典</span><br>    dic_freq_letter = <span class="hljs-built_in">dict</span>()<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> dic_letter_freq.items():<br>        <span class="hljs-keyword">if</span> i[<span class="hljs-number">1</span>] <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> dic_freq_letter.keys():<br>            dic_freq_letter[i[<span class="hljs-number">1</span>]] = [i[<span class="hljs-number">0</span>]]<br>        <span class="hljs-keyword">else</span>:<br>            dic_freq_letter[i[<span class="hljs-number">1</span>]].append(i[<span class="hljs-number">0</span>])<br>    <span class="hljs-comment"># 频数字典排序生成匹配串</span><br>    freq_string = <span class="hljs-string">&#x27;&#x27;</span><br>    <span class="hljs-keyword">for</span> f <span class="hljs-keyword">in</span> <span class="hljs-built_in">sorted</span>(dic_freq_letter.items(),key=<span class="hljs-keyword">lambda</span> x:(-x[<span class="hljs-number">0</span>])):<br>        <span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> f[<span class="hljs-number">1</span>]:<br>            freq_string += c<br>    <span class="hljs-comment"># 累计频率匹配分数</span><br>    <span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> freq_string[:<span class="hljs-number">6</span>]:<br>        <span class="hljs-keyword">if</span> c <span class="hljs-keyword">in</span> ETAOIN[:<span class="hljs-number">6</span>]:<br>            match_score += <span class="hljs-number">1</span><br>    <span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> freq_string[-<span class="hljs-number">6</span>:]:<br>        <span class="hljs-keyword">if</span> c <span class="hljs-keyword">in</span> ETAOIN[-<span class="hljs-number">6</span>:]:<br>            match_score += <span class="hljs-number">1</span><br><br>    <span class="hljs-keyword">return</span>(match_score)<br></code></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># 测试示例中的密文</span><br>message = <span class="hljs-string">&quot;I rc ascwuiluhnviwuetnh,osgaa ice tipeeeee slnatsfietgi tittynecenisl. e fo f fnc isltn sn o a yrs sd onisli ,l erglei trhfmwfrogotn,l stcofiit.aea wesn,lnc ee w,l eIh eeehoer ros iol er snh nl oahsts ilasvih tvfeh rtira id thatnie.im ei-dlmf i thszonsisehroe, aiehcdsanahiec gv gyedsB affcahiecesd d lee onsdihsoc nin cethiTitx eRneahgin r e teom fbiotd n ntacscwevhtdhnhpiwru&quot;</span><br><span class="hljs-built_in">print</span>(freq_match_score(message))<br></code></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">9<br></code></pre></td></tr></table></figure><h3 id="程序化检测英语">程序化检测英语</h3><p>对于置换密码，如果我们用暴力破解方法寻找明文，我们需要测试不同的密钥。只有一个密钥会输出正确的明文，其他密钥输出的是垃圾信息。一旦我们找到了明文，后面的key就不用再尝试了。</p><p>问题:电脑如何区分垃圾信息和英语文本(有实际意义的) ?</p><p>电脑没法区分它们，但是我们注意到英语文本是由可以从字典查找到的单词组成的，而垃圾信息的组成单词我们找不到。如果我们有一个字典文件，每一行是一个英文单词，并且某一个密钥破解后的明文的绝大多数单词都在字典文件中，那么我们可以猜测破解后的明文大概率是我们想要的(假设明文是英语)。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">is_english</span>(<span class="hljs-params">message, word_percentage=<span class="hljs-number">20</span>, letter_percentage=<span class="hljs-number">85</span></span>):<br>  	<span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">  	破解得到的字符串中至少要有20%的单词在字典中，</span><br><span class="hljs-string">  	85%的字符必须是字母或者空格(不是符号或者数字)</span><br><span class="hljs-string">  	word_percentage 和 letter_percentage的默认值可以调整</span><br><span class="hljs-string">  	&quot;&quot;&quot;</span><br>    <span class="hljs-comment"># 加载字典生成字典列表</span><br>    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;dictionary.txt&#x27;</span>, <span class="hljs-string">&#x27;r&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>        wordlist = f.readlines()<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-built_in">len</span>(wordlist)):<br>        wordlist[i] = wordlist[i].rstrip(<span class="hljs-string">&#x27;\n&#x27;</span>)<br>    <span class="hljs-comment"># 英文检测</span><br>    tmp_text = message.upper()<br>    tmp_wordlist = []<br>    tmp_word = <span class="hljs-string">&#x27;&#x27;</span><br>    sum_letter = <span class="hljs-number">0</span><br>    sum_word = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> tmp_text:<br>        <span class="hljs-keyword">if</span> c.isalpha():<br>            tmp_word += c<br>            sum_letter += <span class="hljs-number">1</span><br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-keyword">if</span> c.isspace():<br>                sum_letter += <span class="hljs-number">1</span><br>            tmp_wordlist.append(tmp_word)<br>            tmp_word = <span class="hljs-string">&#x27;&#x27;</span><br>    <span class="hljs-keyword">for</span> w <span class="hljs-keyword">in</span> tmp_wordlist:<br>        <span class="hljs-keyword">if</span> w <span class="hljs-keyword">in</span> wordlist:<br>            sum_word += <span class="hljs-number">1</span><br>    freq_letter = sum_letter / <span class="hljs-built_in">len</span>(tmp_text) * <span class="hljs-number">100</span><br>    freq_word = sum_word / <span class="hljs-built_in">len</span>(tmp_wordlist) * <span class="hljs-number">100</span><br><span class="hljs-comment">#    print(freq_letter)</span><br><span class="hljs-comment">#    print(freq_word)</span><br>    <span class="hljs-keyword">if</span> (freq_letter &gt;= letter_percentage) <span class="hljs-keyword">and</span> (freq_word &gt;= word_percentage):<br>        <span class="hljs-keyword">return</span>(<span class="hljs-literal">True</span>)<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">return</span>(<span class="hljs-literal">False</span>)<br></code></pre></td></tr></table></figure><h3 id="实现破解维吉尼亚密码的主程序">实现破解维吉尼亚密码的主程序</h3><ol><li>获得密钥可能长度的列表;</li><li>对于每个可能的密钥长度，暴力破解密文:<ul><li>获取每组第N个字母构成的字符串(N取值从1到密钥长度);</li><li>对于字母表中的每个字母，尝试用维吉尼亚解密过程解密;</li><li>计算解密后字符串的频率匹配分数，确定密钥每个位置可能的字母;</li><li>尝试密钥每个位置处可能字母的组合，破解密文;</li><li>判断破解后得到的字符串是否为英语，输出提示信息并查看结果，通过结果判断是否继续破解。</li></ul></li></ol><p>用文件ciphertext_vigenere.txt(从QQ群文件下载)中的密文测试破解程序，给出明文。</p><p>考虑到讲义中使用的字母频率分析可能存在的局限性，本人另实现了一种字母频率分析的方法，相比前者更加准确可靠：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># 另一种字母频率分析</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">freq_score</span>(<span class="hljs-params">message</span>):<br>    tmp_text = pre_treatment(message)<br>    dic_freq = <span class="hljs-built_in">dict</span>()<br>    dic_freq = &#123;<span class="hljs-string">&#x27;A&#x27;</span>: <span class="hljs-number">8.167</span>, <span class="hljs-string">&#x27;B&#x27;</span>: <span class="hljs-number">1.492</span>, <span class="hljs-string">&#x27;C&#x27;</span>: <span class="hljs-number">2.782</span>, <span class="hljs-string">&#x27;D&#x27;</span>: <span class="hljs-number">4.253</span>,<br>                <span class="hljs-string">&#x27;E&#x27;</span>: <span class="hljs-number">12.702</span>, <span class="hljs-string">&#x27;F&#x27;</span>: <span class="hljs-number">2.228</span>, <span class="hljs-string">&#x27;G&#x27;</span>: <span class="hljs-number">2.015</span>, <span class="hljs-string">&#x27;H&#x27;</span>: <span class="hljs-number">6.094</span>,<br>                <span class="hljs-string">&#x27;I&#x27;</span>: <span class="hljs-number">6.966</span>, <span class="hljs-string">&#x27;J&#x27;</span>: <span class="hljs-number">0.153</span>, <span class="hljs-string">&#x27;K&#x27;</span>: <span class="hljs-number">0.772</span>, <span class="hljs-string">&#x27;L&#x27;</span>: <span class="hljs-number">4.025</span>,<br>                <span class="hljs-string">&#x27;M&#x27;</span>: <span class="hljs-number">2.406</span>, <span class="hljs-string">&#x27;N&#x27;</span>: <span class="hljs-number">6.749</span>, <span class="hljs-string">&#x27;O&#x27;</span>: <span class="hljs-number">7.507</span>, <span class="hljs-string">&#x27;P&#x27;</span>: <span class="hljs-number">1.929</span>,<br>                <span class="hljs-string">&#x27;Q&#x27;</span>: <span class="hljs-number">0.095</span>, <span class="hljs-string">&#x27;R&#x27;</span>: <span class="hljs-number">5.987</span>, <span class="hljs-string">&#x27;S&#x27;</span>: <span class="hljs-number">6.327</span>, <span class="hljs-string">&#x27;T&#x27;</span>: <span class="hljs-number">9.056</span>,<br>                <span class="hljs-string">&#x27;U&#x27;</span>: <span class="hljs-number">2.758</span>, <span class="hljs-string">&#x27;V&#x27;</span>: <span class="hljs-number">0.978</span>, <span class="hljs-string">&#x27;W&#x27;</span>: <span class="hljs-number">2.360</span>, <span class="hljs-string">&#x27;X&#x27;</span>: <span class="hljs-number">0.150</span>,<br>                <span class="hljs-string">&#x27;Y&#x27;</span>: <span class="hljs-number">1.974</span>, <span class="hljs-string">&#x27;Z&#x27;</span>: <span class="hljs-number">0.074</span>&#125;<br>    count = <span class="hljs-number">0</span><br>    <span class="hljs-built_in">sum</span> = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> tmp_text:<br>        count += <span class="hljs-number">1</span><br>        <span class="hljs-built_in">sum</span> += dic_freq[c]<br>    <span class="hljs-keyword">return</span>(<span class="hljs-built_in">sum</span>/count)<br></code></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># 破解密文主程序</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">kasiski</span>(<span class="hljs-params">message</span>):<br>    flag = <span class="hljs-literal">False</span><br>    <span class="hljs-comment"># 尝试最有可能的5种密钥长度</span><br>    <span class="hljs-keyword">for</span> keylen <span class="hljs-keyword">in</span> get_possible_keylen(message)[:<span class="hljs-number">5</span>]:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;keylen = &#x27;</span>, keylen)<br>        dic_key = <span class="hljs-built_in">dict</span>()<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, keylen):<br>            base_string = get_nth_subkeys_letters(i+<span class="hljs-number">1</span>, keylen, message)<br>            dic_score = <span class="hljs-built_in">dict</span>()<br>            top_guess = <span class="hljs-number">3</span>   <span class="hljs-comment"># 每位密钥测试3个最有可能的字母</span><br>            <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-number">26</span>):<br>                tmp_string = <span class="hljs-string">&#x27;&#x27;</span><br>                <span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> base_string:<br>                    tmp_string += <span class="hljs-built_in">chr</span>(<span class="hljs-built_in">ord</span>(<span class="hljs-string">&#x27;A&#x27;</span>)+(<span class="hljs-built_in">ord</span>(c)-<span class="hljs-built_in">ord</span>(<span class="hljs-string">&#x27;A&#x27;</span>)-j) % <span class="hljs-number">26</span>)<br>                    dic_score[<span class="hljs-built_in">chr</span>(<span class="hljs-built_in">ord</span>(<span class="hljs-string">&#x27;A&#x27;</span>)+j)] = freq_score(tmp_string)<br>            dic_key[i] = <span class="hljs-string">&#x27;&#x27;</span><br>            tmp_count = <span class="hljs-number">0</span><br>            <span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> <span class="hljs-built_in">sorted</span>(dic_score.items(),key=<span class="hljs-keyword">lambda</span> x:-x[<span class="hljs-number">1</span>]):<br>                tmp_count += <span class="hljs-number">1</span><br>                dic_key[i] += k[<span class="hljs-number">0</span>]<br>                <span class="hljs-built_in">print</span>(i,tmp_count, k)<br>                <span class="hljs-keyword">if</span> tmp_count == top_guess:<br>                    <span class="hljs-keyword">break</span><br>        <span class="hljs-built_in">print</span>(dic_key)<br>        <span class="hljs-comment"># 参考二进制思想生成可能密钥</span><br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, top_guess**keylen):<br>            tmp_key = <span class="hljs-string">&#x27;&#x27;</span><br>            <span class="hljs-keyword">if</span> i == <span class="hljs-number">0</span>:<br>                <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, keylen):<br>                    tmp_key += dic_key[j][<span class="hljs-number">0</span>]<br>            <span class="hljs-keyword">else</span>:<br>                tmp = i<br>                dkey = -<span class="hljs-number">1</span><br>                <span class="hljs-keyword">while</span> tmp &gt; <span class="hljs-number">0</span>:<br>                    dkey += <span class="hljs-number">1</span><br>                    dvalue = tmp % top_guess<br>                    tmp_key += dic_key[dkey][dvalue]<br>                    tmp //= top_guess<br>                <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(dkey+<span class="hljs-number">1</span>, keylen):<br>                    tmp_key += dic_key[j][<span class="hljs-number">0</span>]<br>            <span class="hljs-comment"># 尝试解密</span><br>            decrypted_text = vigenere.decrypt(message, tmp_key)<br>            <span class="hljs-keyword">if</span> is_english(decrypted_text):<br>                <span class="hljs-built_in">print</span>(decrypted_text)<br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;key =&#x27;</span>,tmp_key)<br>                flag = <span class="hljs-literal">True</span><br>                <span class="hljs-keyword">break</span><br>        <span class="hljs-keyword">if</span> flag:<br>            <span class="hljs-keyword">break</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():<br>    message = <span class="hljs-string">&#x27;&#x27;</span> <br>    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;ciphertext_vigenere.txt&#x27;</span>,<span class="hljs-string">&#x27;r&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> f.readlines():<br>            message += i<br><br>    <span class="hljs-built_in">print</span>(message)<br><br>    kasiski(message)<br></code></pre></td></tr></table></figure><p>运行结果：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">Adiz Avtzqeci Tmzubb wsa m Pmilqev halpqavtakuoi, lgouqdaf, kdmktsvmztsl, izr xoexghzr kkusitaaf. Vz wsa twbhdg ubalmmzhdad qz hce vmhsgohuqbo ox kaakulmd gxiwvos, krgdurdny i rcmmstugvtawz ca tzm ocicwxfg jf &quot;stscmilpy&quot; oid &quot;uwydptsbuci&quot; wabt hce Lcdwig eiovdnw. Bgfdny qe kddwtk qjnkqpsmev ba pz tzm roohwz at xoexghzr kkusicw izr vrlqrwxist uboedtuuznum. Pimifo Icmlv Emf DI, Lcdwig owdyzd xwd hce Ywhsmnemzh Xovm mby Cqxtsm Supacg (GUKE) oo Bdmfqclwg Bomk, Tzuhvif&#x27;a ocyetzqofifo ositjm. Rcm a lqys ce oie vzav wr Vpt 8, lpq gzclqab mekxabnittq tjr Ymdavn fihog cjgbhvnstkgds. Zm psqikmp o iuejqf jf lmoviiicqg aoj jdsvkavs Uzreiz qdpzmdg, dnutgrdny bts helpar jf lpq pjmtm, mb zlwkffjmwktoiiuix avczqzs ohsb ocplv nuby swbfwigk naf ohw Mzwbms umqcifm. Mtoej bts raj pq kjrcmp oo tzm Zooigvmz Khqauqvl Dincmalwdm, rhwzq vz cjmmhzd gvq ca tzm rwmsl lqgdgfa rcm a kbafzd-hzaumae kaakulmd, hce SKQ. Wi 1948 Tmzubb jgqzsy Msf Zsrmsv&#x27;e Qjmhcfwig Dincmalwdm vt Eizqcekbqf Pnadqfnilg, ivzrw pq onsaafsy if bts yenmxckmwvf ca tzm Yoiczmehzr uwydptwze oid tmoohe avfsmekbqr dn eifvzmsbuqvl tqazjgq. Pq kmolm m dvpwz ab ohw ktshiuix pvsaa at hojxtcbefmewn, afl bfzdakfsy okkuzgalqzu xhwuuqvl jmmqoigve gpcz ie hce Tmxcpsgd-Lvvbgbubnkq zqoxtawz, kciup isme xqdgo otaqfqev qz hce 1960k. Bgfdny&#x27;a tchokmjivlabk fzsmtfsy if i ofdmavmz krgaqqptawz wi 1952, wzmz vjmgaqlpad iohn wwzq goidt uzgeyix wi tzm Gbdtwl Wwigvwy. Vz aukqdoev bdsvtemzh rilp rshadm tcmmgvqg (xhwuuqvl uiehmalqab) vs sv mzoejvmhdvw ba dmikwz. Hpravs rdev qz 1954, xpsl whsm tow iszkk jqtjrw pug 42id tqdhcdsg, rfjm ugmbddw xawnofqzu. Vn avcizsl lqhzreqzsy tzif vds vmmhc wsa eidcalq; vds ewfvzr svp gjmw wfvzrk jqzdenmp vds vmmhc wsa mqxivmzhvl. Gv 10 Esktwunsm 2009, fgtxcrifo mb Dnlmdbzt uiydviyv, Nfdtaat Dmiem Ywiikbqf Bojlab Wrgez avdw iz cafakuog pmjxwx ahwxcby gv nscadn at ohw Jdwoikp scqejvysit xwd &quot;hce sxboglavs kvy zm ion tjmmhzd.&quot; Sa at Haq 2012 i bfdvsbq azmtmd&#x27;g widt ion bwnafz tzm Tcpsw wr Zjrva ivdcz eaigd yzmbo Tmzubb a kbmhptgzk dvrvwz wa efiohzd.<br>keylen =  3<br>0 1 (&#x27;A&#x27;, 5.125612431444254)<br>0 2 (&#x27;M&#x27;, 5.112906764168203)<br>0 3 (&#x27;Z&#x27;, 4.292806215722134)<br>1 1 (&#x27;O&#x27;, 5.333315018315032)<br>1 2 (&#x27;S&#x27;, 5.273826007326018)<br>1 3 (&#x27;D&#x27;, 4.486067765567781)<br>2 1 (&#x27;I&#x27;, 5.830117216117233)<br>2 2 (&#x27;V&#x27;, 5.392289377289392)<br>2 3 (&#x27;E&#x27;, 4.267117216117228)<br>&#123;0: &#x27;AMZ&#x27;, 1: &#x27;OSD&#x27;, 2: &#x27;IVE&#x27;&#125;<br>keylen =  2<br>0 1 (&#x27;I&#x27;, 4.810197560975626)<br>0 2 (&#x27;O&#x27;, 4.562274390243913)<br>0 3 (&#x27;A&#x27;, 4.415186585365871)<br>1 1 (&#x27;M&#x27;, 4.557256410256414)<br>1 2 (&#x27;V&#x27;, 4.542681318681341)<br>1 3 (&#x27;I&#x27;, 4.338537240537258)<br>&#123;0: &#x27;IOA&#x27;, 1: &#x27;MVI&#x27;&#125;<br>keylen =  6<br>0 1 (&#x27;A&#x27;, 6.367591240875909)<br>0 2 (&#x27;P&#x27;, 5.041430656934308)<br>0 3 (&#x27;E&#x27;, 4.885160583941612)<br>1 1 (&#x27;S&#x27;, 6.245344322344322)<br>1 2 (&#x27;H&#x27;, 4.7055934065934135)<br>1 3 (&#x27;W&#x27;, 4.369351648351649)<br>2 1 (&#x27;I&#x27;, 6.8673223443223455)<br>2 2 (&#x27;T&#x27;, 4.873608058608065)<br>2 3 (&#x27;E&#x27;, 4.650586080586077)<br>3 1 (&#x27;M&#x27;, 6.306934065934067)<br>3 2 (&#x27;Z&#x27;, 4.561073260073258)<br>3 3 (&#x27;Q&#x27;, 4.492465201465203)<br>4 1 (&#x27;O&#x27;, 6.575586080586089)<br>4 2 (&#x27;D&#x27;, 4.607542124542126)<br>4 3 (&#x27;Z&#x27;, 4.570794871794874)<br>5 1 (&#x27;V&#x27;, 6.368021978021977)<br>5 2 (&#x27;I&#x27;, 4.7929120879120966)<br>5 3 (&#x27;Z&#x27;, 4.592890109890112)<br>&#123;0: &#x27;APE&#x27;, 1: &#x27;SHW&#x27;, 2: &#x27;ITE&#x27;, 3: &#x27;MZQ&#x27;, 4: &#x27;ODZ&#x27;, 5: &#x27;VIZ&#x27;&#125;<br>Alan Mathison Turing was a British mathematician, logician, cryptanalyst, and computer scientist. He was highly influential in the development of computer science, providing a formalisation of the concepts of &quot;algorithm&quot; and &quot;computation&quot; with the Turing machine. Turing is widely considered to be the father of computer science and artificial intelligence. During World War II, Turing worked for the Government Code and Cypher School (GCCS) at Bletchley Park, Britain&#x27;s codebreaking centre. For a time he was head of Hut 8, the section responsible for German naval cryptanalysis. He devised a number of techniques for breaking German ciphers, including the method of the bombe, an electromechanical machine that could find settings for the Enigma machine. After the war he worked at the National Physical Laboratory, where he created one of the first designs for a stored-program computer, the ACE. In 1948 Turing joined Max Newman&#x27;s Computing Laboratory at Manchester University, where he assisted in the development of the Manchester computers and became interested in mathematical biology. He wrote a paper on the chemical basis of morphogenesis, and predicted oscillating chemical reactions such as the Belousov-Zhabotinsky reaction, which were first observed in the 1960s. Turing&#x27;s homosexuality resulted in a criminal prosecution in 1952, when homosexual acts were still illegal in the United Kingdom. He accepted treatment with female hormones (chemical castration) as an alternative to prison. Turing died in 1954, just over two weeks before his 42nd birthday, from cyanide poisoning. An inquest determined that his death was suicide; his mother and some others believed his death was accidental. On 10 September 2009, following an Internet campaign, British Prime Minister Gordon Brown made an official public apology on behalf of the British government for &quot;the appalling way he was treated.&quot; As of May 2012 a private member&#x27;s bill was before the House of Lords which would grant Turing a statutory pardon if enacted.<br>key = ASIMOV<br></code></pre></td></tr></table></figure><h2 id="实验总结">实验总结</h2><p>本门实验的讲义是本学期所有实验中最具有<strong>引导</strong>、<strong>启发性</strong>的讲义。通过本次实验，加深了我对于python这门编程语言的掌握情况，理解并实现了维吉尼亚密码，在完成频率分析、唯密文攻击时，收获了极大的成就感，受益匪浅。</p></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者:</span> <span class="post-copyright-info"><a href="mailto:undefined" rel="external nofollow noreferrer">Foo</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接:</span> <span class="post-copyright-info"><a href="https://foopi.top/posts/314e2427/">https://foopi.top/posts/314e2427/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明:</span> <span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="external nofollow noreferrer" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://foopi.top" target="_blank">Time of Pi</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/python/">python</a></div><div class="post_share"></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://img.foopi.top/img/loading.gif" data-lazy-src="https://img.foopi.top/img/avatar.webp" onerror='this.onerror=null,this.src="/img/friend_404.gif"' alt="avatar"></div><div class="author-info__name">Foo</div><div class="author-info__description"></div></div><div class="card-info-data is-center"><div class="card-info-data-item"><a href="/archives/"><div class="headline">文章</div><div class="length-num">28</div></a></div><div class="card-info-data-item"><a href="/tags/"><div class="headline">标签</div><div class="length-num">11</div></a></div><div class="card-info-data-item"><a href="/categories/"><div class="headline">分类</div><div class="length-num">12</div></a></div></div><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/lucifer9735" rel="external nofollow noreferrer" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:lucifer9735@gmail.com" rel="external nofollow noreferrer" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">欢迎来访，喜欢请收藏w</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E7%9B%AE%E7%9A%84"><span class="toc-number">1.</span> <span class="toc-text">实验目的</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E5%86%85%E5%AE%B9"><span class="toc-number">2.</span> <span class="toc-text">实验内容</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E5%8E%9F%E7%90%86%E5%92%8C%E6%AD%A5%E9%AA%A4"><span class="toc-number">3.</span> <span class="toc-text">实验原理和步骤</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E4%B8%80%E9%83%A8%E5%88%86-%E7%BB%B4%E5%90%89%E5%B0%BC%E4%BA%9A%E5%AF%86%E7%A0%81%E5%8A%A0%E8%A7%A3%E5%AF%86"><span class="toc-number">4.</span> <span class="toc-text">第一部分:维吉尼亚密码加解密</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BC%96%E7%A0%81%E5%AE%9E%E7%8E%B0%E7%BB%B4%E5%90%89%E5%B0%BC%E4%BA%9A%E5%AF%86%E7%A0%81%E5%8A%A0%E8%A7%A3%E5%AF%86%E8%BF%87%E7%A8%8B"><span class="toc-number">4.1.</span> <span class="toc-text">编码实现维吉尼亚密码加解密过程</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E4%BA%8C%E9%83%A8%E5%88%86-%E7%BB%B4%E5%90%89%E5%B0%BC%E4%BA%9A%E5%94%AF%E5%AF%86%E6%96%87%E6%94%BB%E5%87%BB"><span class="toc-number">5.</span> <span class="toc-text">第二部分:维吉尼亚唯密文攻击</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8D%A1%E8%A5%BF%E6%96%AF%E5%9F%BA%E8%AF%95%E9%AA%8C-Kasiski-Examination"><span class="toc-number">5.1.</span> <span class="toc-text">卡西斯基试验(Kasiski Examination)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BB%8E%E5%AF%86%E6%96%87%E4%B8%AD%E6%89%BE%E5%87%BA%E6%8B%BC%E5%86%99%E5%AE%8C%E5%85%A8%E7%9B%B8%E5%90%8C%E7%9A%84%E5%AD%97%E7%AC%A6%E4%B8%B2-%E6%95%B0%E8%BF%99%E4%BA%9B%E7%9B%B8%E5%90%8C%E7%9A%84%E5%AD%97%E7%AC%A6%E4%B8%B2%E4%B8%AD%E9%97%B4%E9%97%B4%E9%9A%94%E7%9A%84%E5%AD%97%E6%AF%8D%E6%95%B0"><span class="toc-number">5.1.1.</span> <span class="toc-text">从密文中找出拼写完全相同的字符串;数这些相同的字符串中间间隔的字母数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%89%BE%E5%88%B0%E9%97%B4%E9%9A%94%E4%B9%8B%E9%97%B4%E7%9A%84%E5%9B%A0%E6%95%B0"><span class="toc-number">5.1.2.</span> <span class="toc-text">找到间隔之间的因数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B0%86%E5%AF%86%E6%96%87%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%8C%89%E7%85%A7%E5%AF%86%E9%92%A5%E9%95%BF%E5%BA%A6%E5%88%86%E7%BB%84%EF%BC%8C%E5%B9%B6%E8%8E%B7%E5%8F%96%E6%AF%8F%E7%BB%84%E4%B8%AD%E7%AC%ACN%E4%B8%AA%E5%AD%97%E6%AF%8D"><span class="toc-number">5.1.3.</span> <span class="toc-text">将密文字符串按照密钥长度分组，并获取每组中第N个字母</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AF%B9%E4%B8%8A%E9%9D%A2%E5%BE%97%E5%88%B0%E7%9A%84%E5%AD%97%E7%AC%A6%E4%B8%B2%E7%94%A8%E9%A2%91%E7%8E%87%E5%88%86%E6%9E%90%E7%A0%B4%E8%A7%A3%E5%BE%97%E5%88%B0%E5%AF%86%E9%92%A5%E4%B8%AD%E7%9A%84%E6%AF%8F%E4%B8%AA%E5%AD%97%E6%AF%8D"><span class="toc-number">5.1.4.</span> <span class="toc-text">对上面得到的字符串用频率分析破解得到密钥中的每个字母</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E9%A2%91%E7%8E%87%E5%88%86%E6%9E%90"><span class="toc-number">5.1.4.1.</span> <span class="toc-text">频率分析</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A8%8B%E5%BA%8F%E5%8C%96%E6%A3%80%E6%B5%8B%E8%8B%B1%E8%AF%AD"><span class="toc-number">5.2.</span> <span class="toc-text">程序化检测英语</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9E%E7%8E%B0%E7%A0%B4%E8%A7%A3%E7%BB%B4%E5%90%89%E5%B0%BC%E4%BA%9A%E5%AF%86%E7%A0%81%E7%9A%84%E4%B8%BB%E7%A8%8B%E5%BA%8F"><span class="toc-number">5.3.</span> <span class="toc-text">实现破解维吉尼亚密码的主程序</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E6%80%BB%E7%BB%93"><span class="toc-number">6.</span> <span class="toc-text">实验总结</span></a></li></ol></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2021 - 2022 By Foo</div><div class="framework-info"><span>框架</span> <a target="_blank" rel="noopener external nofollow noreferrer" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题</span> <a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><script>var preloader={endLoading:()=>{document.body.style.overflow="auto",document.getElementById("loading-box").classList.add("loaded")},initLoading:()=>{document.body.style.overflow="",document.getElementById("loading-box").classList.remove("loaded")}};window.addEventListener("load",preloader.endLoading())</script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>