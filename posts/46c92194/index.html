<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"><title>基于公钥体制的加密和数字签名实现 | Time of Pi</title><meta name="author" content="Foo"><meta name="copyright" content="Foo"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="计算机与网络安全综合实验（二）"><meta property="og:type" content="article"><meta property="og:title" content="基于公钥体制的加密和数字签名实现"><meta property="og:url" content="https://foopi.top/posts/46c92194/index.html"><meta property="og:site_name" content="Time of Pi"><meta property="og:description" content="计算机与网络安全综合实验（二）"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://img.foopi.top/cover/yunhe5.webp"><meta property="article:published_time" content="2021-05-24T06:13:44.000Z"><meta property="article:modified_time" content="2022-04-03T06:25:02.045Z"><meta property="article:author" content="Foo"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://img.foopi.top/cover/yunhe5.webp"><link rel="shortcut icon" href="https://img.foopi.top/img/favicon.webp"><link rel="canonical" href="https://foopi.top/posts/46c92194/"><link rel="preconnect" href="//cdn.jsdelivr.net"><link rel="preconnect" href="//static.cloudflareinsights.com"><link rel="preconnect" href="//busuanzi.ibruce.info"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6/css/all.min.css" media="print" onload='this.media="all"'><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css" media="print" onload='this.media="all"'><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.css" media="print" onload='this.media="all"'><script defer data-pjax="data-pjax" src="https://static.cloudflareinsights.com/beacon.min.js" data-cf-beacon="{&quot;token&quot;: &quot;1167d76d896d415ebda0de73b6b5f2e8&quot;}"></script><script>const GLOBAL_CONFIG={root:"/",algolia:void 0,localSearch:void 0,translate:void 0,noticeOutdate:void 0,highlight:{plugin:"highlighjs",highlightCopy:!0,highlightLang:!0,highlightHeightLimit:192},copy:{success:"复制成功",error:"复制错误",noSupport:"浏览器不支持"},relativeDate:{homepage:!1,post:!0},runtime:"天",date_suffix:{just:"刚刚",min:"分钟前",hour:"小时前",day:"天前",month:"个月前"},copyright:void 0,lightbox:"fancybox",Snackbar:{chs_to_cht:"你已切换为繁体",cht_to_chs:"你已切换为简体",day_to_night:"你已切换为深色模式",night_to_day:"你已切换为浅色模式",bgLight:"#49b1f5",bgDark:"#121212",position:"bottom-left"},source:{justifiedGallery:{js:"https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.js",css:"https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.css"}},isPhotoFigcaption:!1,islazyload:!0,isAnchor:!0}</script><script id="config-diff">var GLOBAL_CONFIG_SITE={title:"基于公钥体制的加密和数字签名实现",isPost:!0,isHome:!1,isHighlightShrink:!1,isToc:!0,postUpdate:"2022-04-03 14:25:02"}</script><noscript><style>#nav{opacity:1}.justified-gallery img{opacity:1}#post-meta time,#recent-posts time{display:inline!important}</style></noscript><script>(e=>{e.saveToLocal={set:function(e,t,o){if(0===o)return;const n=864e5*o,a={value:t,expiry:(new Date).getTime()+n};localStorage.setItem(e,JSON.stringify(a))},get:function(e){const t=localStorage.getItem(e);if(!t)return;const o=JSON.parse(t);if(!((new Date).getTime()>o.expiry))return o.value;localStorage.removeItem(e)}},e.getScript=e=>new Promise((t,o)=>{const n=document.createElement("script");n.src=e,n.async=!0,n.onerror=o,n.onload=n.onreadystatechange=function(){const e=this.readyState;e&&"loaded"!==e&&"complete"!==e||(n.onload=n.onreadystatechange=null,t())},document.head.appendChild(n)}),e.activateDarkMode=function(){document.documentElement.setAttribute("data-theme","dark"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","#0d0d0d")},e.activateLightMode=function(){document.documentElement.setAttribute("data-theme","light"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","#ffffff")};const t=saveToLocal.get("theme");"dark"===t?activateDarkMode():"light"===t&&activateLightMode();const o=saveToLocal.get("aside-status");void 0!==o&&("hide"===o?document.documentElement.classList.add("hide-aside"):document.documentElement.classList.remove("hide-aside"));/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)&&document.documentElement.classList.add("apple")})(window)</script><meta name="generator" content="Hexo 5.4.1"></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">加载中...</div></div></div><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://img.foopi.top/img/loading.gif" data-lazy-src="https://img.foopi.top/img/avatar.webp" onerror='onerror=null,src="/img/friend_404.gif"' alt="avatar"></div><div class="site-data is-center"><div class="data-item"><a href="/archives/"><div class="headline">文章</div><div class="length-num">28</div></a></div><div class="data-item"><a href="/tags/"><div class="headline">标签</div><div class="length-num">11</div></a></div><div class="data-item"><a href="/categories/"><div class="headline">分类</div><div class="length-num">12</div></a></div></div><hr><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i> <span>Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i> <span>Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i> <span>Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i> <span>Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i> <span>links</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image:url(https://img.foopi.top/cover/yunhe5.webp)"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">Time of Pi</a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i> <span>Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i> <span>Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i> <span>Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i> <span>Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i> <span>links</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">基于公钥体制的加密和数字签名实现</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2021-05-24T06:13:44.000Z" title="发表于 2021-05-24 14:13:44">2021-05-24</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2022-04-03T06:25:02.045Z" title="更新于 2022-04-03 14:25:02">2022-04-03</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E6%83%B3%E8%A6%81%E6%AF%95%E4%B8%9A/">想要毕业</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E6%83%B3%E8%A6%81%E6%AF%95%E4%B8%9A/%E7%BD%91%E7%BB%9C%E4%B8%8E%E5%8D%8F%E8%AE%AE%E5%AE%89%E5%85%A8/">网络与协议安全</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">4.1k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>14分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" data-flag-title="基于公钥体制的加密和数字签名实现"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h2 id="实验二-基于公钥体制的加密和数字签名实现">实验二 基于公钥体制的加密和数字签名实现</h2><h3 id="实验内容">实验内容</h3><p>实现一个基于公钥算法的数字签名系统。以 RSA 为例，具体要求如下：</p><ol><li>能够对指定字符串（或其消息摘要）进行签名形成签名文，对签名文进行解密并与源字符串进行比对，验证其正确性；</li><li>必须输出签名有关的各项参数：如公钥、私钥，通过乘积构成大整数的两个素数等；</li><li>实现一个较完善的系统。</li></ol><h3 id="实验目的">实验目的</h3><p>目前，一般通过加密与解密、身份确认、数字签名等方法来保证信息存储与传输的安全。本实验的目的是使学生能够深入掌握公钥加解密算法、数字签名的基本原理，从而对密码学的公钥密码体制加解密、数字签名与身份认证、密钥管理等相关知识的系统应用有深入的理解。</p><h3 id="实验原理">实验原理</h3><p>1976 年，美国学者 Diffie 和 Hellman 为解决信息公开传送和密钥管理问题，提出一种新的密钥交换协议，允许在不安全的媒体上的通讯双方交换信息，安全地达成一致的密钥，这就是“公开密钥系统”。相对于“对称加密算法”，这种方法也叫做“非对称加密算法”。与对称加密算法不同，非对称加密算法需要两个密钥：公开密钥(publickey)和私有密钥 (privatekey)。公开密钥与私有密钥是一对，如果用公开密钥对数据进行加密，只有用对应的私有密钥才能解密；如果用私有密钥对数据进行加密，那么只有用对应的公开密钥才能解密。因为加密和解密使用的是两个不同的密钥，所以这种算法叫作非对称加密算法。非对称加密算法实现机密信息交换的基本过程是：甲方生成一对密钥并将其中的一把作为公用密钥向其它方公开；得到该公用密钥的乙方使用该密钥对机密信息进行加密后发送给 甲方；甲方再用自己保存的另一把专用密钥对加密后的信息进行解密。甲方只能用其专用密钥解密由其公用密钥加密后的任何信息。非对称加密算法的保密性比较好，它消除了最终用户交换密钥的需要，但加密和解密花费时间长、速度慢，不适合于对文件加密而只适用于对少量数据进行加密。</p><h4 id="公钥密码算法介绍">公钥密码算法介绍</h4><p>使用公开密钥对文件进行加密传输的实际过程包括四步:</p><ol><li>发送方生成一个自己的私有密钥并用接收方的公开密钥对自己的私有密钥进行加密，然后通过网络传输到接收方；</li><li>发送方对需要传输的文件用自己的私有密钥进行加密，然后通过网络把加密后的文件传输到接收方；</li><li>接收方用自己的公开密钥进行解密后得到发送方的私有密钥；</li><li>接受方用发送方的私有密钥对文件进行解密得到文件的明文形式。</li></ol><p>因为只有接收方才拥有自己的公开密钥，所以即使其他人得到了经过加密的发送方的私有密钥，也因为无法进行解密而保证了私有密钥的安全性，从而也保证了传输文件的安全性。实际上，上述在文件传输过程中实现了两个加密解密过程：文件本身的加密和解密与私有密钥的加密解密，这分别通过私有密钥和公开密钥来实现。</p><h4 id="私钥数字签名技术">私钥数字签名技术</h4><p>对文件进行加密只解决了传送信息的保密问题，而防止他人对传输的文件进行破坏，以及如何确定发信人的身份还需要采取其它的手段，这一手段就是数字签名。在电子商务安全保密系统中，数字签名技术有着特别重要的地位，在电子商务安全服务中的源鉴别、完整性服务、不可否认服务中，都要用到数字签名技术。在电子商务中，完善的数字签名应具备签字方不能抵赖、他人不能伪造、在公证人面前能够验证真伪的能力。</p><p>实现数字签名有很多方法，目前数字签名采用较多的是公钥加密技术，如基于 RSA Date Security 公司的 PKCS(Public Key Cryptography Standards)、Digital Signature Algorithm、 x.509、PGP(Pretty Good Privacy)。1994 年美国标准与技术协会公布了数字签名标准而使公钥加密技术广泛应用。公钥加密系统采用的是非对称加密算法。</p><p>目前的数字签名是建立在公共密钥体制基础上，它是公用密钥加密技术的另一类应用。 它的主要方式是，报文的发送方从报文文本中生成一个 128 位的散列值(或报文摘要)。发送方用自己的私人密钥对这个散列值进行加密来形成发送方的数字签名。然后，这个数字签名将作为报文的附件和报文一起发送给报文的接收方。报文的接收方首先从接收到的原始报文中计算出 128 位的散列值(或报文摘要)，接着再用发送方的公用密钥来对报文附加的数字签名进行解密。如果两个散列值相同，那么接收方就能确认该数字签名是发送方的。 通过数字签名能够实现对原始报文的鉴别。</p><p>数字签名与书面文件签名有相同之处。采用数字签名，也能确认以下两点：第一，信息是由签名者发送的；第二，信息自签发后到收到为止未曾作过任何修改。这样数字签名就可用来防止电子信息因易被修改而有人作伪，或冒用别人名义发送信息，或发出(收到) 信件后又加以否认等情况发生。应用广泛的数字签名方法主要有三种，即：RSA 签名、DSS 签名和 Hash 签名。这三种算法可单独使用，也可综合在一起使用。数字签名是通过密码算法对数据进行加、解密变换实现的，用 DES 算法、RSA 算法都可实现数字签名。但三种技术或多或少都有缺陷，或者没有成熟的标准。</p><p>RSA 算法中数字签名技术实际上是通过一个哈希函数来实现的。数字签名的特点是它代表了文件的特征，文件如果发生改变，数字签名的值也将发生变化。不同的文件将得到不同的数字签名。一个最简单的哈希函数是把文件的二进制码相累加，取最后的若干位。 哈希函数对发送数据的双方都是公开的。</p><p>DSS 数字签名是由美国国家标准化研究院和国家安全局共同开发的。由于它是由美国政府颁布实施的，主要用于与美国政府做生意的公司，其他公司则较少使用，它只是一个签名系统，而且美国政府不提倡使用任何削弱政府窃听能力的加密软件，认为这才符合美国的国家利益。</p><p>Hash 签名是最主要的数字签名方法，也称之为数字摘要法(Digital Digest)或数字指纹法(Digital Finger Print)。它与 RSA 数字签名是单独的签名不同，该数字签名方法是将数字签名与要发送的信息紧密联系在一起，它更适合于电子商务活动。将一个商务合同的个体内容与签名结合在一起，比合同和签名分开传递，更增加了可信度和安全性。数字摘要(Digital Digest)加密方法亦称安全 Hash 编码法(SHA:Secure Hash Algorithm)或 MD5(MD Standard For Message Digest)，由 RonRivest 所设计。该编码法采用单向 Hash 函数将需加密的明文“摘要”成一串 128bit 的密文，这一串密文亦称为数字指纹(Finger Print)，它有固定的长度，且不同的明文摘要必定一致。这样这串摘要可成为验证明文是否是“真身”的“指纹”。</p><p>只有加入数字签名及验证才能真正实现在公开网络上的安全传输。加入数字签名和验证的文件传输过程如下：</p><ol><li>发送方首先用哈希函数从原文得到数字签名，然后采用公开密钥体系用发送方的私有密钥对数字签名进行加密，并把加密后的数字签名附加在要发送的原文后面；</li><li>发送方选择一个秘密密钥对文件进行加密，并把加密后的文件通过网络传输到接收方；</li><li>发送方用接收方的公开密钥对密秘密钥进行加密，并通过网络把加密后的秘密密钥传输到接收方；</li><li>接受方使用自己的私有密钥对密钥信息进行解密，得到秘密密钥的明文；</li><li>接收方用秘密密钥对文件进行解密，得到经过加密的数字签名；</li><li>接收方用发送方的公开密钥对数字签名进行解密，得到数字签名的明文；</li><li>接收方用得到的原文明文和哈希函数重新计算数字签名，并与解密后的数字签名进行对比。如果两个数字签名是相同的，说明文件在传输过程中没有被破坏。</li></ol><h3 id="设计分析">设计分析</h3><p>RSA 签名程序涉及很多个数学运算步骤，程序可以分成若干个模块。</p><ol><li><p>模加运算、模乘运算和模幂运算模块</p><ol><li>模加运算<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>a</mi><mo>+</mo><mi>b</mi><mo stretchy="false">)</mo><mspace></mspace><mspace width="0.6667em"><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext> </mtext><mtext> </mtext><mi>n</mi></mrow><annotation encoding="application/x-tex">(a+b)\mod n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal">b</span><span class="mclose">)</span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:.6667em"></span></span><span class="base"><span class="strut" style="height:.6944em"></span><span class="mord"><span class="mord"><span class="mord mathrm">mod</span></span></span><span class="mspace" style="margin-right:.1667em"></span><span class="mspace" style="margin-right:.1667em"></span><span class="mord mathnormal">n</span></span></span></span> 等价于<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>a</mi><mspace></mspace><mspace width="0.6667em"><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext> </mtext><mtext> </mtext><mi>n</mi><mo>+</mo><mi>b</mi><mspace></mspace><mspace width="0.6667em"><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext> </mtext><mtext> </mtext><mi>n</mi><mo stretchy="false">)</mo><mspace></mspace><mspace width="0.6667em"><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext> </mtext><mtext> </mtext><mi>n</mi></mrow><annotation encoding="application/x-tex">(a\mod n +b\mod n)\mod n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord mathnormal">a</span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:.6667em"></span></span><span class="base"><span class="strut" style="height:.7778em;vertical-align:-.0833em"></span><span class="mord"><span class="mord"><span class="mord mathrm">mod</span></span></span><span class="mspace" style="margin-right:.1667em"></span><span class="mspace" style="margin-right:.1667em"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222em"></span></span><span class="base"><span class="strut" style="height:.6944em"></span><span class="mord mathnormal">b</span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:.6667em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord"><span class="mord"><span class="mord mathrm">mod</span></span></span><span class="mspace" style="margin-right:.1667em"></span><span class="mspace" style="margin-right:.1667em"></span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:.6667em"></span></span><span class="base"><span class="strut" style="height:.6944em"></span><span class="mord"><span class="mord"><span class="mord mathrm">mod</span></span></span><span class="mspace" style="margin-right:.1667em"></span><span class="mspace" style="margin-right:.1667em"></span><span class="mord mathnormal">n</span></span></span></span></li><li>模乘运算及计算两个数的乘积然后取模。为了避免大数相乘造成的溢出，根据求模运算的性质，优化算法，其中<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mi>b</mi><mspace></mspace><mspace width="0.6667em"><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext> </mtext><mtext> </mtext><mi>n</mi></mrow><annotation encoding="application/x-tex">ab\mod n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6944em"></span><span class="mord mathnormal">ab</span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:.6667em"></span></span><span class="base"><span class="strut" style="height:.6944em"></span><span class="mord"><span class="mord"><span class="mord mathrm">mod</span></span></span><span class="mspace" style="margin-right:.1667em"></span><span class="mspace" style="margin-right:.1667em"></span><span class="mord mathnormal">n</span></span></span></span> 等价于<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>a</mi><mspace></mspace><mspace width="0.6667em"><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext> </mtext><mtext> </mtext><mi>n</mi><mo stretchy="false">)</mo><mo stretchy="false">(</mo><mi>b</mi><mspace></mspace><mspace width="0.6667em"><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext> </mtext><mtext> </mtext><mi>n</mi><mo stretchy="false">)</mo><mspace></mspace><mspace width="0.6667em"><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext> </mtext><mtext> </mtext><mi>n</mi></mrow><annotation encoding="application/x-tex">(a\mod n)(b\mod n)\mod n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord mathnormal">a</span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:.6667em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord"><span class="mord"><span class="mord mathrm">mod</span></span></span><span class="mspace" style="margin-right:.1667em"></span><span class="mspace" style="margin-right:.1667em"></span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mopen">(</span><span class="mord mathnormal">b</span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:.6667em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord"><span class="mord"><span class="mord mathrm">mod</span></span></span><span class="mspace" style="margin-right:.1667em"></span><span class="mspace" style="margin-right:.1667em"></span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:.6667em"></span></span><span class="base"><span class="strut" style="height:.6944em"></span><span class="mord"><span class="mord"><span class="mord mathrm">mod</span></span></span><span class="mspace" style="margin-right:.1667em"></span><span class="mspace" style="margin-right:.1667em"></span><span class="mord mathnormal">n</span></span></span></span></li><li>模幂运算就是计算一个数的 n 次幂，然后进行取模运算。这里编程可以使用一些数学技巧，另外同样要考虑避免大数相乘造成溢出的问题。(可参考教材P121)</li></ol></li><li><p>素性测试算法:Solovay-Strassen素性测试算法、Miller-Rabin素性测试算法或其他检测方法</p></li><li><p>大数的加法与减法运算</p></li><li><p>求最大公约数 可利用欧几里德的辗转相除法</p></li><li><p>随机数的产生(可参照教材 7 .2 节)</p></li><li><p>计算私钥</p></li><li><p>密钥的管理(可参照教材第7章)</p></li><li><p>签名消息摘要的生成(可利用MD5、SHA-1算法或其他算法，参考教材第8章)</p></li><li><p>签名与验证过程</p></li></ol><h3 id="实验步骤">实验步骤</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> random<br><span class="hljs-keyword">import</span> hashlib<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">rabin_miller</span>(<span class="hljs-params">num</span>):<br>    s = num - <span class="hljs-number">1</span><br>    t = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">while</span> s % <span class="hljs-number">2</span> == <span class="hljs-number">0</span>:<br>        s = s // <span class="hljs-number">2</span><br>        t += <span class="hljs-number">1</span><br>    <span class="hljs-keyword">for</span> trials <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">5</span>):<br>        a = random.randrange(<span class="hljs-number">2</span>, num - <span class="hljs-number">1</span>)<br>        v = <span class="hljs-built_in">pow</span>(a, s, num)<br>        <span class="hljs-keyword">if</span> v != <span class="hljs-number">1</span>:<br>            i = <span class="hljs-number">0</span><br>            <span class="hljs-keyword">while</span> v != (num - <span class="hljs-number">1</span>):<br>                <span class="hljs-keyword">if</span> i == t - <span class="hljs-number">1</span>:<br>                    <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br>                <span class="hljs-keyword">else</span>:<br>                    i = i + <span class="hljs-number">1</span><br>                    v = (v ** <span class="hljs-number">2</span>) % num<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">is_prime</span>(<span class="hljs-params">num</span>):<br>    <span class="hljs-comment"># 排除0,1和负数</span><br>    <span class="hljs-keyword">if</span> num &lt; <span class="hljs-number">2</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br>    <span class="hljs-comment"># 创建小素数的列表,可以大幅加快速度</span><br>    small_primes = [<span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">5</span>, <span class="hljs-number">7</span>, <span class="hljs-number">11</span>, <span class="hljs-number">13</span>, <span class="hljs-number">17</span>, <span class="hljs-number">19</span>, <span class="hljs-number">23</span>, <span class="hljs-number">29</span>, <span class="hljs-number">31</span>, <span class="hljs-number">37</span>, <span class="hljs-number">41</span>, <span class="hljs-number">43</span>, <span class="hljs-number">47</span>, <span class="hljs-number">53</span>, <span class="hljs-number">59</span>, <span class="hljs-number">61</span>, <span class="hljs-number">67</span>, <span class="hljs-number">71</span>, <span class="hljs-number">73</span>, <span class="hljs-number">79</span>, <span class="hljs-number">83</span>, <span class="hljs-number">89</span>, <span class="hljs-number">97</span>, <span class="hljs-number">101</span>, <span class="hljs-number">103</span>, <span class="hljs-number">107</span>, <span class="hljs-number">109</span>, <span class="hljs-number">113</span>, <span class="hljs-number">127</span>, <span class="hljs-number">131</span>, <span class="hljs-number">137</span>, <span class="hljs-number">139</span>, <span class="hljs-number">149</span>, <span class="hljs-number">151</span>, <span class="hljs-number">157</span>, <span class="hljs-number">163</span>, <span class="hljs-number">167</span>, <span class="hljs-number">173</span>, <span class="hljs-number">179</span>, <span class="hljs-number">181</span>, <span class="hljs-number">191</span>, <span class="hljs-number">193</span>, <span class="hljs-number">197</span>, <span class="hljs-number">199</span>, <span class="hljs-number">211</span>, <span class="hljs-number">223</span>, <span class="hljs-number">227</span>, <span class="hljs-number">229</span>, <span class="hljs-number">233</span>, <span class="hljs-number">239</span>, <span class="hljs-number">241</span>, <span class="hljs-number">251</span>, <span class="hljs-number">257</span>, <span class="hljs-number">263</span>, <span class="hljs-number">269</span>, <span class="hljs-number">271</span>, <span class="hljs-number">277</span>, <span class="hljs-number">281</span>, <span class="hljs-number">283</span>, <span class="hljs-number">293</span>, <span class="hljs-number">307</span>, <span class="hljs-number">311</span>, <span class="hljs-number">313</span>, <span class="hljs-number">317</span>, <span class="hljs-number">331</span>, <span class="hljs-number">337</span>, <span class="hljs-number">347</span>, <span class="hljs-number">349</span>, <span class="hljs-number">353</span>, <span class="hljs-number">359</span>, <span class="hljs-number">367</span>, <span class="hljs-number">373</span>, <span class="hljs-number">379</span>, <span class="hljs-number">383</span>, <span class="hljs-number">389</span>, <span class="hljs-number">397</span>, <span class="hljs-number">401</span>, <span class="hljs-number">409</span>, <span class="hljs-number">419</span>, <span class="hljs-number">421</span>, <span class="hljs-number">431</span>, <span class="hljs-number">433</span>, <span class="hljs-number">439</span>, <span class="hljs-number">443</span>, <span class="hljs-number">449</span>, <span class="hljs-number">457</span>, <span class="hljs-number">461</span>, <span class="hljs-number">463</span>, <span class="hljs-number">467</span>, <span class="hljs-number">479</span>, <span class="hljs-number">487</span>, <span class="hljs-number">491</span>, <span class="hljs-number">499</span>, <span class="hljs-number">503</span>, <span class="hljs-number">509</span>, <span class="hljs-number">521</span>, <span class="hljs-number">523</span>, <span class="hljs-number">541</span>, <span class="hljs-number">547</span>, <span class="hljs-number">557</span>, <span class="hljs-number">563</span>, <span class="hljs-number">569</span>, <span class="hljs-number">571</span>, <span class="hljs-number">577</span>, <span class="hljs-number">587</span>, <span class="hljs-number">593</span>, <span class="hljs-number">599</span>, <span class="hljs-number">601</span>, <span class="hljs-number">607</span>, <span class="hljs-number">613</span>, <span class="hljs-number">617</span>, <span class="hljs-number">619</span>, <span class="hljs-number">631</span>, <span class="hljs-number">641</span>, <span class="hljs-number">643</span>, <span class="hljs-number">647</span>, <span class="hljs-number">653</span>, <span class="hljs-number">659</span>, <span class="hljs-number">661</span>, <span class="hljs-number">673</span>, <span class="hljs-number">677</span>, <span class="hljs-number">683</span>, <span class="hljs-number">691</span>, <span class="hljs-number">701</span>, <span class="hljs-number">709</span>, <span class="hljs-number">719</span>, <span class="hljs-number">727</span>, <span class="hljs-number">733</span>, <span class="hljs-number">739</span>, <span class="hljs-number">743</span>, <span class="hljs-number">751</span>, <span class="hljs-number">757</span>, <span class="hljs-number">761</span>, <span class="hljs-number">769</span>, <span class="hljs-number">773</span>, <span class="hljs-number">787</span>, <span class="hljs-number">797</span>, <span class="hljs-number">809</span>, <span class="hljs-number">811</span>, <span class="hljs-number">821</span>, <span class="hljs-number">823</span>, <span class="hljs-number">827</span>, <span class="hljs-number">829</span>, <span class="hljs-number">839</span>, <span class="hljs-number">853</span>, <span class="hljs-number">857</span>, <span class="hljs-number">859</span>, <span class="hljs-number">863</span>, <span class="hljs-number">877</span>, <span class="hljs-number">881</span>, <span class="hljs-number">883</span>, <span class="hljs-number">887</span>, <span class="hljs-number">907</span>, <span class="hljs-number">911</span>, <span class="hljs-number">919</span>, <span class="hljs-number">929</span>, <span class="hljs-number">937</span>, <span class="hljs-number">941</span>, <span class="hljs-number">947</span>, <span class="hljs-number">953</span>, <span class="hljs-number">967</span>, <span class="hljs-number">971</span>, <span class="hljs-number">977</span>, <span class="hljs-number">983</span>, <span class="hljs-number">991</span>, <span class="hljs-number">997</span>]<br>    <span class="hljs-comment"># 如果是小素数,那么直接返回true</span><br>    <span class="hljs-keyword">if</span> num <span class="hljs-keyword">in</span> small_primes:<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br>    <span class="hljs-comment"># 如果大数是这些小素数的倍数,那么就是合数,返回false</span><br>    <span class="hljs-keyword">for</span> prime <span class="hljs-keyword">in</span> small_primes:<br>        <span class="hljs-keyword">if</span> num % prime == <span class="hljs-number">0</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br>    <span class="hljs-comment"># 如果这样没有分辨出来,就一定是大整数,那么就调用rabin算法</span><br>    <span class="hljs-keyword">return</span> rabin_miller(num)<br><br><span class="hljs-comment"># 得到随机大素数,默认位数为1024</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_prime</span>(<span class="hljs-params">key_size</span>):<br>    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>        num = random.randrange(<span class="hljs-number">2</span>**(key_size-<span class="hljs-number">1</span>), <span class="hljs-number">2</span>**key_size)<br>        <span class="hljs-keyword">if</span> is_prime(num):<br>            <span class="hljs-keyword">return</span> num<br><br><span class="hljs-comment"># 欧几里得算法求两个数字的最大公约数</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">gcd</span>(<span class="hljs-params">a, b</span>):<br>    <span class="hljs-keyword">if</span> b == <span class="hljs-number">0</span>:<br>        <span class="hljs-keyword">return</span> a<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">return</span> gcd(b, a % b)<br><span class="hljs-comment"># 扩展欧几里得</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">ext_gcd</span>(<span class="hljs-params">a, b</span>):<br>    <span class="hljs-keyword">if</span> b == <span class="hljs-number">0</span>:<br>        x1 = <span class="hljs-number">1</span><br>        y1 = <span class="hljs-number">0</span><br>        x = x1<br>        y = y1<br>        r = a<br>        <span class="hljs-keyword">return</span> r, x, y<br>    <span class="hljs-keyword">else</span>:<br>        r, x1, y1 = ext_gcd(b, a % b)<br>        x = y1<br>        y = x1 - (a // b ) * y1<br>        <span class="hljs-keyword">return</span> r, x, y        <br><span class="hljs-comment"># 使用快速幂取模计算法进行加密解密</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">power</span>(<span class="hljs-params">a, b, c</span>):<br>    s = <span class="hljs-number">1</span><br>    a %= c<br>    <span class="hljs-keyword">while</span> b != <span class="hljs-number">0</span>:<br>        <span class="hljs-keyword">if</span> b % <span class="hljs-number">2</span> == <span class="hljs-number">1</span>:<br>            s = (s * a) % c<br>        b = b // <span class="hljs-number">2</span><br>        a = (a * a) % c<br>    <span class="hljs-keyword">return</span> s<br><span class="hljs-comment"># 生成RSA公钥私钥</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">gen_key</span>(<span class="hljs-params">p, q</span>):<br>    n = p * q<br>    fn = (p - <span class="hljs-number">1</span>) * (q - <span class="hljs-number">1</span>) <span class="hljs-comment"># 欧拉函数</span><br>    b = fn<br>    e = get_prime(<span class="hljs-number">16</span>)<br>    j = gcd(e,b)<br>    <span class="hljs-keyword">while</span> j != <span class="hljs-number">1</span>:<br>        e = get_prime(<span class="hljs-number">16</span>)<br>        j = gcd(e,b)<br>    a = e<br>    b = fn<br>    r, x, y = ext_gcd(a, b)<br>    <span class="hljs-keyword">while</span> x &lt;=<span class="hljs-number">0</span>: <br>        x += fn <span class="hljs-comment">#将负逆元转正</span><br>    d = x<br><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;生成的公钥e为:\n&quot;</span>, e)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;生成的私钥d为:\n&quot;</span>, d)<br>    <span class="hljs-keyword">return</span> (n, e), (n, d)<br><span class="hljs-comment"># 加密 m是被加密的信息 加密成为c</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">encrypt</span>(<span class="hljs-params">m, pubkey</span>):<br>  n = pubkey[<span class="hljs-number">0</span>]<br>  e = pubkey[<span class="hljs-number">1</span>]<br>  c = power(m, e, n)<br>  <span class="hljs-keyword">return</span> c<br><span class="hljs-comment"># 解密 c是密文，解密为明文m</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">decrypt</span>(<span class="hljs-params">c, selfkey</span>):<br>  n = selfkey[<span class="hljs-number">0</span>]<br>  d = selfkey[<span class="hljs-number">1</span>]<br>  m = power(c, d, n)<br>  <span class="hljs-keyword">return</span> m<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():<br>    <span class="hljs-comment"># RSA秘钥生成</span><br>    pubkey = []<br>    selfkey = []<br>    <span class="hljs-comment"># 公钥私钥中用到的两个1024位大素数p,q</span><br>    p = get_prime(<span class="hljs-number">1024</span>)<br>    q = get_prime(<span class="hljs-number">1024</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;随机取两个1024位的大素数分别为:&quot;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;p:\n&quot;</span>, p)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;q:\n&quot;</span>, q)<br>    pubkey, selfkey = gen_key(p, q)<br><br>    <span class="hljs-comment"># 数字签名</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;请您输入要加密的明文:&quot;</span>)<br>    mstr = <span class="hljs-built_in">input</span>(<span class="hljs-string">&#x27;&#x27;</span>)<br>    m = <span class="hljs-built_in">bytes</span>(mstr, encoding = <span class="hljs-string">&quot;utf8&quot;</span>)<br>    md = hashlib.md5()<br>    md.update(m)<br>    <span class="hljs-comment"># 用MD5算法生成消息摘要hm</span><br>    hm = <span class="hljs-built_in">int</span>(md.hexdigest(), <span class="hljs-number">16</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Alice生成的消息摘要为:\n&quot;</span>, hm)<br>    <span class="hljs-comment"># 计算签名</span><br>    <span class="hljs-comment"># Alice用自己的私钥计算签名s</span><br>    s = encrypt(hm, selfkey)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Alice计算出的签名s为:\n&quot;</span>, s)<br>    <span class="hljs-comment"># Alice将(m, s)发送个Bob</span><br><br>    <span class="hljs-comment"># Bob验证签名是否有效</span><br>    flag = <span class="hljs-literal">True</span><br>    <span class="hljs-comment"># Bob用公钥计算出消息摘要</span><br>    res = decrypt(s, pubkey)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Bob计算出的消息摘要为:\n&quot;</span>, res)<br>    <span class="hljs-keyword">if</span> res == hm:<br>        flag =<span class="hljs-literal">True</span><br>    <span class="hljs-keyword">else</span>:<br>        flag = <span class="hljs-literal">False</span><br>    <span class="hljs-comment"># 将验证结果输出</span><br>    <span class="hljs-keyword">if</span> flag == <span class="hljs-literal">True</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Alice的签名 有效&quot;</span>)<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Alice的签名 无效&quot;</span>)<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    main()<br></code></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs shell">随机取两个1024位的大素数分别为:<br>p:<br> 126840546322120293706358756821908489630070790079046472804746119073768334625490365235083022536479566981823190933258178790509366579533832001267306165107863085881113761435350873546230365271035747675885320413506208387435237682844409604996551723798124453562497393425348367844145601028559043967964302680971669417377<br>q:<br> 110015871372188294328891465519179826099958495864993626451841666624000747692567617935532732521379526898233104333486259881137351638956572103832908054241130064173209828070415271883177555779056193787850518343659717024191559503731469891829587545767457582829392810068943226121265300923506971384737838641826181989599<br>生成的公钥e为:<br> 54577<br>生成的私钥d为:<br> 3281705918126775852692348898803114863540750647926630044204586914660706149456768281569130750667346570555934119342673867092098064435249876860547572956022377064444798811206959277759287586946639818291955407734521878630206331887209471238218063789272705556490071412119825560783998889227538682005647903885805057246879198124743114781119068432094351227696489713393373313433102696886587463273541350691093986481934401983300987621909796401685796870740690103302888975489490339535236596526002227721518911073270181461161399921797239518350782039246018477078364494201792334417597634696152185622777340387672322847655316392815975809553<br>请您输入要加密的明文:<br>in 55!W !<br>Alice生成的消息摘要为:<br> 207778089911345749567590398469007700519<br>Alice计算出的签名s为:<br> 12585735280468047095842933579143691342646624427994934537433451418153230312809211508585728071860779031205364878831339603978791995981921969862944737508430134213997245255632702656148806137341048229980087430200635237062508178960663278740046275554238836208862907502133506206749972830158437627039346045841002990565884315551692930428183962150017923662389847110983789961789305955882143474639303881910489273058955868066332712344789616974144364651369622467170638614242424478995954708716854902165675072789205161605561668310657919000641024952567270776112319505307371319697520961070355399235340852078916948151059417240082551980633<br>Bob计算出的消息摘要为:<br> 207778089911345749567590398469007700519<br>Alice的签名 有效<br></code></pre></td></tr></table></figure><h3 id="思考题">思考题</h3><ol><li>查阅资料，了解一些其他的公钥密码体制，如 ElGamal 公约密码体制、Diffie-Hellman密钥协商方案(基于求解离散对数的难解问题)、椭圆曲线密码体制(基于椭圆曲线离散对数的难解问题)等，认识它们的基本原理和实现机制。</li><li>查阅资料，进一步了解其他签名方案如 DSA 算法，分析这些签名方案的基本原理和实现机制等，以及它们与 RSA 的区别和联系。</li></ol><h3 id="实验总结">实验总结</h3><p>熟悉了RSA公钥密码体制并实现了数字签名的生成和验证。</p></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者:</span> <span class="post-copyright-info"><a href="mailto:undefined" rel="external nofollow noreferrer">Foo</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接:</span> <span class="post-copyright-info"><a href="https://foopi.top/posts/46c92194/">https://foopi.top/posts/46c92194/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明:</span> <span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="external nofollow noreferrer" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://foopi.top" target="_blank">Time of Pi</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"></div><div class="post_share"></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://img.foopi.top/img/loading.gif" data-lazy-src="https://img.foopi.top/img/avatar.webp" onerror='this.onerror=null,this.src="/img/friend_404.gif"' alt="avatar"></div><div class="author-info__name">Foo</div><div class="author-info__description"></div></div><div class="card-info-data is-center"><div class="card-info-data-item"><a href="/archives/"><div class="headline">文章</div><div class="length-num">28</div></a></div><div class="card-info-data-item"><a href="/tags/"><div class="headline">标签</div><div class="length-num">11</div></a></div><div class="card-info-data-item"><a href="/categories/"><div class="headline">分类</div><div class="length-num">12</div></a></div></div><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/lucifer9735" rel="external nofollow noreferrer" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:lucifer9735@gmail.com" rel="external nofollow noreferrer" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">欢迎来访，喜欢请收藏w</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E4%BA%8C-%E5%9F%BA%E4%BA%8E%E5%85%AC%E9%92%A5%E4%BD%93%E5%88%B6%E7%9A%84%E5%8A%A0%E5%AF%86%E5%92%8C%E6%95%B0%E5%AD%97%E7%AD%BE%E5%90%8D%E5%AE%9E%E7%8E%B0"><span class="toc-number">1.</span> <span class="toc-text">实验二 基于公钥体制的加密和数字签名实现</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E5%86%85%E5%AE%B9"><span class="toc-number">1.1.</span> <span class="toc-text">实验内容</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E7%9B%AE%E7%9A%84"><span class="toc-number">1.2.</span> <span class="toc-text">实验目的</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E5%8E%9F%E7%90%86"><span class="toc-number">1.3.</span> <span class="toc-text">实验原理</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%85%AC%E9%92%A5%E5%AF%86%E7%A0%81%E7%AE%97%E6%B3%95%E4%BB%8B%E7%BB%8D"><span class="toc-number">1.3.1.</span> <span class="toc-text">公钥密码算法介绍</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%A7%81%E9%92%A5%E6%95%B0%E5%AD%97%E7%AD%BE%E5%90%8D%E6%8A%80%E6%9C%AF"><span class="toc-number">1.3.2.</span> <span class="toc-text">私钥数字签名技术</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AE%BE%E8%AE%A1%E5%88%86%E6%9E%90"><span class="toc-number">1.4.</span> <span class="toc-text">设计分析</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E6%AD%A5%E9%AA%A4"><span class="toc-number">1.5.</span> <span class="toc-text">实验步骤</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%80%9D%E8%80%83%E9%A2%98"><span class="toc-number">1.6.</span> <span class="toc-text">思考题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E6%80%BB%E7%BB%93"><span class="toc-number">1.7.</span> <span class="toc-text">实验总结</span></a></li></ol></li></ol></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2021 - 2022 By Foo</div><div class="framework-info"><span>框架</span> <a target="_blank" rel="noopener external nofollow noreferrer" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题</span> <a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><script>var preloader={endLoading:()=>{document.body.style.overflow="auto",document.getElementById("loading-box").classList.add("loaded")},initLoading:()=>{document.body.style.overflow="",document.getElementById("loading-box").classList.remove("loaded")}};window.addEventListener("load",preloader.endLoading())</script><div class="js-pjax"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css"><script src="https://cdn.jsdelivr.net/npm/katex@latest/dist/contrib/copy-tex.min.js"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/contrib/copy-tex.css"><script>document.querySelectorAll("#article-container span.katex-display").forEach(a=>{btf.wrap(a,"div",{class:"katex-wrap"})})</script></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>